|******************************************************************************
|* tdisg v  831tv  0  VRC B61U a7 live
|* Custom Invoice dll Report
|* baan
|* 2020-03-17 [14:43]
|******************************************************************************
|* 
|* GH489CR000, RAvi Kumar, 11-02-2021
|* 169703-Correction in Custom Invoice functionality to Post same Tax code and Isgec Registration in E-Invoicing and GSTR-2
|*
|* GH524CR000, RAvi Kumar, 17-03-2021
|* Due to limitation of character limit in BaaN, please allow to print full name of company  in "Annexure to export Invoice No
|******************************************************************************
|Custom Invoice Report Tables *************************************************
	table   	ttdisg831 | Export Dispatch Request Data
	table		ttdisg800
	table		ttdisg832
	table		ttdisg878
	table		ttccom000
	table		ttccom130
	table		ttdisg825
	table		ttpisg036
	table		ttpisg037
	table		ttcmcs010
	table		ttcibd001	| Item generals		
	table		ttdisg007
	table		ttcmcs041
	table		ttccom100
	table		ttdisg863
	table		ttdisg864
	table		ttdisg876
	table		ttdisg839
	table		ttppdm740
	table		ttcmcs002
	table		ttpisg031
	table		ttpisg045
	table		ttctax940
	table		ttfacp100
	table		ttcmcs052
	table		ttccom139
	table		ttdisg860
	table		twhinh312		|
	table		ttdisg865
	table		tciisg800
	table		ttcisg132

|************************* Commercial Invoice Report Tables ***********************************
table	twhisg312
table	twhwmd260
table	twhinh200
table	twhinh220
table   ttdisg843
table   ttdisg845
table	ttdisg861
table	ttdisg866
table	ttpppc215
table	ttdisg830
table	ttdisg865
Table	tdmisg134
|**********************************************************************************************
|Draft Invoice Tables
table	tttaad200
table	ttpisg031
table	ttpisg030
table	tciisg000
table	ttppin020
table	twhinh310
table	ttfisg002	
table	ttfisg003	
table	ttcmcs010
table	ttcmcs143
table	ttccom100
table	ttctax941
table	ttcmcs036
table	ttcmcs032
						|# ISGEC004011.sn
table  tdmisg121
table	tdmisg123
table   tdmisg125
table   tdmisg131
table   tdmisg132
Table	tdmisg100
table   tdmisg126
table   tdmisg127
table   tdmisg128
table   ttccom001
table   tdmisg133
table   ttfisg405
						
						|# ISGEC004011.en
table	ttccom120				|#ISGEC016026.n		



table	ttctax940
	table	ttpisg039
	table  ttcemm170
	table	tciisg000
	table	tciisg101
	table	ttfacp100
	table	ttpisg131
	table	twhisg311
	table	ttpisg031	
	table	ttpisg122
	table	ttcmcs143
	table	ttccom139
	table	ttcemm030
	table	tciisg801
	table	tcisli205

|*********************************************************************************************
|Draft Invoice Report Variable
extern	domain tcorno           edrn.f    fixed
extern 	domain	tcorno          edrn.t    fixed

extern	domain	tcdate		curr.date	
extern	domain	tcratc		exc.rate	
extern	domain	tfgld.user	curr.user

extern	domain	tcdsca		dsca1,dsca2,dsca3,dsca4,dsca5,dsca6,dsca7
extern	domain	tcmcs.str100	term.line, net.payable.line, lut.line
extern	domain	tcmcs.str4	nill.val
extern	domain	tcamnt		amnt1,amnt2,amnt3,amnt4,amnt5, lc.amnt, final.total, sum.lc.amnt
extern	domain	tcamnt		inr.amnt, tot.inr.amnt, lc.amnt.inr, final.total.inr, sum.lc.amnt.inr
extern	domain	tcdsca		country_from,country_to,place_from,place_to	
extern	domain	tcdsca		excise,cess,shcess,cst1
extern	domain	tcamnt		excise.rate,cess.rate,shcess.rate,cst.rate,billing_amount,tax.value
extern	domain	tcccty		cdf.rtyp
extern	domain	tcmcs.long	irnumber,i.rcno
extern	domain	tcamnt		i.advance,i.retention,i.total,i.subtotal
extern	domain	whinh.shpm	v.rcno
extern	domain	tcfovn		gstn.b.no

extern	domain	tcnama		bpname
extern	domain	tcsrnb		o.srno
extern	domain	tcmcs.str50	p.line
extern	domain	tcmcs.str215	cash.str
|*********************************************************************************************
#include <bic_dam>
#include <bic_text>
|Custom Invoice Report Variables ****************************************************************
extern	domain	tcmcs.str30m	line5,line6,line
extern	domain	tcnama		nama,nama1
extern	domain	tcmcs.str90	r.word1,v.lacs,lacs,decode0,decode1,decode2,decode3,decode4,decode5,decode6,decode7
extern	domain	tcamnt		lac,tot_amount,tot_nwgt,tot_gwgt
extern	domain	tcpstc		line7,line71
extern	domain	tcorno          var.edrn
extern	domain	tcmcs.str50	factory1,factory2,factory3,factory4,factory5
extern	domain	tcmcs.str50	buyer1,buyer2,buyer3,buyer4,buyer5,value_declare
extern	domain	tcmcs.str50	con1,con2,con3,con4,con5,exp1,exp2,exp3,exp4,exp5
extern	domain	tcclot		buyer_order,inco_term,mode,label.f
extern	domain	tcdsca		delivery_term
extern	domain	tfgld.date	buyer_date
extern	domain	tcclot		type1,type2,type3,type4,type5,type6,type7
long				v.item|,p
extern	domain	tcpono		srno,nopk1,nopk2,nopk3,nopk4,nopk5,nopk6,nopk7,v.nopk,v.nopk1
extern	domain	tcmcs.long	p,i,tot.nopk,tmp.nopk,total.pack,q,linem,z,q
extern	domain	tcmcs.str10	lumpsum,i.packed
extern	domain	tcmcs.str80	rate.type.line
extern domain  tcyesno		detail90.yn
extern	domain	tcbool		free.line
extern	domain	tcmcs.str50	heading,dbk_description1,dbk_description2,description1,description2, hsn.desc
extern	domain	tcmcs.str50	dbk_description3,dbk_description4
extern	domain	tcmcs.str50	hsn.description1, hsn.description2, hsn.description3, hsn.description4
long ret_val
| Variable for Report - Export DIspatch STatus ****************

extern domain	tcmcs.str100m	chaadd1,chaadd2,chaadd3,chaadd4
extern	domain	tcmcs.str15	i.rate,i.rfac,i.nwgt,i.gwgt,i.arev,i.dbkb,i.prbf,i.package
extern 	domain  tcorno		orno,i.size,i.size1,i.size2,i.size3,i.size4,i.size5,i.size6	|#ISG001041.sn
extern	domain	tcorno		i.type,i.type1,i.type2,i.type3,i.type4,i.type5,i.type6
extern	domain	tcpono		i.noct,i.noct1,i.noct2,i.noct3,i.noct4,i.noct5,i.noct6
extern	domain	tcclot		type_shipment,v.type,v.type1
extern	domain	tcyesno		edbk.v, efps.v, efms.v
extern	domain	tcqiv1		v.pqty
extern	domain	tccuni		v.pcun
|Variable for Report - Draft Bill of Lading ************

extern	domain	tcmcs.str50	shipper1,shipper2,shipper3,shipper4,shipper5
extern	domain	tcmcs.str50	consignee1,consignee2,consignee3,consignee4,consignee5
extern	domain	tcdsca		label1,label2,label3,label4,label5,report_desc,
				port_discharge,port_loading
extern	domain	tcwght		gross_weight
extern	domain	tcmcs.str100	package_no,dbk_des1,dbk_des2,dbk_des3,dbk_des4,dbk_des5,term_delivery, meis.des1, meis.des2, meis.des3	|RAvi.a.GH.04012021
extern domain	tcmcs.str100 	dbk_des6,dbk_des7, dbk_des8, dbk_des9	|ISGEC01158.n
extern	domain	tcamnt		amnt.inr
extern	domain	tcmcs.str5	i.rev
|***************** Custom Invoice Report Variable End *****************************

|Commercial INvoice Report Variable **********************************************
extern	domain	tcmcs.str12	temp.blno
extern	domain	tccom.bpid	temp.cons
extern	domain	tfgld.date	temp.date
extern	domain	tcorno		temp.pold, temp.pods, temp.pldv
extern	domain	tcdsca		temp.vfln, temp.voyg
extern	domain	tcccty		temp.coor, temp.cofd
extern	domain	tcdesc		temp.itod
extern	domain	tcmcs.str15	temp.lcno
extern	domain	tcsern		temp.srno
extern domain  tcyesno		detail90.yn
extern domain  tcorno		orno
extern domain  tcpono		pono,seqn, xyz
extern domain  tcwset		oset
extern	domain	tcmcs.str70	text(2), text1,text2
long		rt1,get.data
string		error(100),error1(100)
	|* Report Variables
extern	domain	tcnama		i.bpid.dsca
extern	domain	tcnama		i.cons.dsca
extern	domain	tcdsca		i.origin.ccty
extern	domain	tcdsca		i.dest.ccty
extern	domain	tcmcs.str60	all.our.ref
extern	domain	tcpono		srno
extern	domain	tcamnt		i.total.cif,net.pay,i.total.fob,tot_nwgt,tot_gwgt
extern	domain	tcamnt		i.fob.amount,i.freight,i.insurance
extern	domain	tcamnt		i.advance.payment,i.ret.payment,lac
extern	domain	tcmcs.long	tot.nopk,tmp.nopk,total.pack,linem,z
extern	domain	tcmcs.str100m	i.exp.ln01,i.exp.ln02,i.exp.ln03,i.exp.ln04
extern	domain	tcmcs.str100m	i.bp.ln01,i.bp.ln02,i.bp.ln03,i.bp.ln04
extern	domain	tcdisc		o.total.adv.perc,o.total.ret.perc
domain	tcbool		first.call,i.first.customer
domain	tclogn		i.user
extern	domain	tcmcs.str50		buyer1,buyer2,buyer3,buyer4,buyer5
extern	domain	tcmcs.str50		con1,con2,con3,con4,con5,container_no
extern	domain	tcmcs.str50	exp1,exp2,exp3,exp4,exp5
extern	domain	tcmcs.str50	goods1,goods2,goods3,goods4,goods5,goods6
extern	domain	tcclot		inco_term,mode
extern	domain	tcdsca		delivery_term,desc,desc1,desc2,desc3,desc4
extern	domain	tcmcs.str50	i.heading
extern	domain	tcmcs.str90	r.word1,v.lacs,lacs,decode0,decode1,decode2,decode3,decode4,decode5,decode6,decode7
extern	domain	tcmcs.str60	custom_invoice
extern	domain	tcmcs.str60	custom.invoice(7)
extern	domain	tcmcs.str15	packing_qty
extern	domain	tcbool	free.line
extern	domain	tcmcs.long	i.pos, repeat.flag
extern	domain	tcclot		i.item
| extern domain tcpono 		p,q
extern	domain	tcmcs.str100m	description3		|#ISGEC01031.n
							|#CR458.sn
	extern	domain	tcmcs.str60	r.var.vhno
		domain	tfgld.docn	var.dino
			long		i.vhno	
							|#CR458.en
							|#ISGEC004011.sn
|Transmittal variables
extern	domain tcdsca	sending,sub
extern	domain tcdsca	submission
extern	domain	tcdsca	sent
| extern	domain tcdsca	sending_array(8)		|#ISGEC016003.o
extern	domain tcdsca	sending_array(50)			|#ISGEC016003.n
| extern	domain tcdsca	submission_array(8)		|#ISGEC016003.o
extern	domain tcdsca	submission_array(50)			|#ISGEC016003.n
| extern	domain	tcdsca	sent_array(8)			|#ISGEC016003.o
extern	domain	tcdsca	sent_array(50)				|#ISGEC016003.n
extern	domain 	tcpono	tran.print, serial
extern	domain	tcnama	transmittal, contact.name, created.by, issued.by, approver.by
extern	domain	tcmcs.str100	subject.1, subject.2
extern	domain	tcmcs.str100	note.1, note.2, note.3, mail.cc
extern	domain	tcdsca	user.dept, appr.dept, address.1, address.2, address.3, address.4
			, address.5, address.6	|#ISGEC016026.n
extern	domain	tcmcs.str20	po.dsca, cin.no.export, iec.no.export, pan.no.export			|RAvi.a.GH177CR495
extern	domain	tctax.txnb	gstn.c.no	|#ISGEC017006.n
extern	domain	tcorno		invoice.no	|#ISGEC017006.n
extern	domain	tcamnt		tot.amnt	|#ISGEC017006.n
	extern	long	curr.comp						|RAvi.a.GH177CR495
							|# ISGEC004011.en
							
							




extern	domain	tcnama		o.cus.nama, o.user.name
extern	domain	tcmcs.str100m	o.cus.ln01
extern	domain	tcmcs.str100m	o.cus.ln02
extern	domain	tcmcs.str100m	o.cus.ln03
extern	domain	tcmcs.str100m	o.cus.ln04
extern	domain	tcmcs.str100m	o.cus.ln05
extern	domain	tcmcs.str100m	o.cus.ln06
extern	domain	tctelp		o.cus.telp
extern	domain	tcccty		o.cus.ccty
extern	domain	tcmcs.cste	o.cus.cste

extern	domain	tcnama		o.cons.nama
extern	domain	tcmcs.str100m	o.cons.ln01
extern	domain	tcmcs.str100m	o.cons.ln02
extern	domain	tcmcs.str100m	o.cons.ln03
extern	domain	tcmcs.str100m	o.cons.ln04
extern	domain	tcmcs.str100m	o.cons.ln05
extern	domain	tcmcs.str100m	o.cons.ln06
extern	domain	tctelp		o.cons.telp
extern	domain	tcccty		o.cons.ccty
extern	domain	tcmcs.cste	o.cons.cste

extern	domain	tcnama		o.regn.nama
extern	domain	tcmcs.str100m	o.regn.ln01
extern	domain	tcmcs.str100m	o.regn.ln02
extern	domain	tcmcs.str100m	o.regn.ln03
extern	domain	tcmcs.str100m	o.regn.ln04
extern	domain	tcmcs.str100m	o.regn.ln05
extern	domain	tcmcs.str100m	o.regn.ln06
extern	domain	tctelp		o.regn.telp
extern	domain	tcccty		o.regn.ccty
extern	domain	tcmcs.cste	o.regn.cste

extern	domain	tccom.cadr	o.regn.cadr

extern	domain	tcmcs.str80m	full.name

extern domain  tctax.txnb	temp.ser.tax			
extern domain  tctax.txnb	temp.tan.tax			

|***********  REPORT VARIABLES *****************
| extern	domain	tcmcs.str15	invoice.no
| extern	domain	tfgld.year	o.tfgld018.year
extern	domain	tfgld.prod	o.tfgld018.prod

extern	domain	tctax.txnb	lst.tctax400.fovn
extern	domain	tctax.txnb	cst.tctax400.fovn
extern	domain	tctax.txnb	ser.tctax400.fovn
extern	domain	tctax.txnb	tan.tctax400.fovn

extern	domain	tctax.txnb.l	o.lst.tctax940
extern	domain	tctax.txnb.l	o.cst.tctax940

extern	domain	tcnama		ofbp.nama
extern	domain	tcnama		itbp.nama

extern	domain	tfgld.amnt	adv.tfacr200.amth	
extern	domain	tfgld.amnt	adv.gst.amnt	
extern	domain	tfgld.amnt	ret.tfacr200.amth	

extern	domain	tfgld.amnt	o.freight1, o.excise1,o.vat1, o.cst1,o.service1	

extern	domain	tcdsca		our.state.dsca
extern	domain	tctelp		our.telp
extern	domain	tcmcs.str100m	our.address

extern	domain	tcamnt		gross.invoice

extern	long print.gr	
extern	long print.tax

extern	domain	tcmcs.str40		from.place
extern	domain	tcmcs.str40		to.place

extern	domain	tcmcs.str50	gr.number 
extern	domain	tcnama		gr.bp.nama
extern	domain	tcnama		ir.bp.nama

extern	domain	tcmcs.str15	invoice.type
extern	domain	tcmcs.str50		company.name
extern	domain	tcmcs.str50	own.line1, own.line2
extern	domain	tcbool		actual.shipment
extern 	domain	tcnama		o.tfacp100.nama

extern domain tcdsca          ncmp.name					|PATCH001008.sn
extern domain tcncmp          ncmp.code					|PATCH001008.en
extern domain tcsrnb		o.srno	|#ISGEC017006.n
extern domain tcmcs.str100	r.str	|#GH185CR501.n
extern domain tcdsca          ncmp.name					|PATCH001008.sn
extern domain tcncmp          ncmp.code					|PATCH001008.en
extern domain tcsrnb		o.srno	|#ISGEC017006.n
extern domain tcmcs.str100	r.str	|#GH185CR501.n

	extern	domain tcamnt		total.assv.val 
	extern	domain tcamnt		total.cgst.amnt
	extern	domain tcamnt		total.sgst.amnt
	extern	domain tcamnt		total.igst.amnt
	extern	domain tcamnt		total.cess.amnt
	extern	domain tcamnt		total.tcs.amnt
	extern	domain tcamnt		net.amnt
	extern	domain tcmcs.str215 	net.amnt.str, tot.amnt.str
	extern	domain tcmcs.str15	pan.no
| 	extern	domain tcmcs.str25	cin.no
| 	extern	domain tcmcs.str215	test22

		domain	tcncmp		get.ncmp







	domain tccom.cadr	own.cadr	|#ISGEC017006.n
| extern	domain	tfgld.amnt	o.cisli206.txah
	domain	tcmcs.cste	temp.cste	|#ISGEC017006.sn
	domain	tcccty		temp.ccty	|#ISGEC017006.en
| 	domain	tfacp.isup	gr.no.array(20)				|#ISGEC001229.o
	domain	tfacp.isup	gr.no.array(100)  			|#ISGEC001229.n
	domain	tfgld.date	gr.date.array(23)
	domain	tcbool		gr.is.printed
| 		long		m, n					|#ISGEC001229.o				
		long		m, n,i.count				|#ISGEC001229.n
	domain	tcorno	i.edrn	|ISGEC016023
	
	domain	tcmcs.str100	f.ser.inp.path, temp.path, f.path	
	domain	tcmcs.long	fp, ret2, file.pntr
	string			file.name(100), local.file.name(100), temp.file(100),recover.msg(500)
	
	string 	kw1(17) mb, kw2(17) mb, kw3(17) mb, kw4(17) mb | Keywords of
							       | text
	string 	opwd(15) 				       | Text window
	string 	txtg(8)  				       | Text group
	long	txt.pntr, txt.pntr1, txt.pntr2, txt.pntr3
	string	temp.text1(999), temp.text(999), get.text(999), get.text1(900)

	extern	domain	tcamnt	cgst.amnt, sgst.amnt, igst.amnt, assv.val, tax.amnt, total.amnt.r
	extern	domain	tcpvat		cgst.rate, sgst.rate, igst.rate
	extern	domain	tcamnt		tot.inr.amnt.with.tax, tot.tax.amnt		|RAvi.a.12102020
	extern	domain	tfgld.date	date.280520			|GH324CR636.a
			long		invoice.line.count, ann.line.cal		|RAvi.a.20102020
		domain	tfgld.docn	docn.orno		|RAvi.a.18112020
		domain	tcorno		docn.orno.str		|RAvi.a.18112020
		domain	tfgld.ttyp	ityp			|RAvi.a.18112020
	extern	domain	tcmcs.str100m	vender.name.cadr		|GH524CR000.a
#include<bic_desktop>
#include <bic_text>
	
	#pragma used dll otcmcsdll0036
	#pragma used dll otctaxdll9141.l

#pragma used dll ottstpapihand
|COMMERCIAL INVOICE VARIABLE DECLARATION END *************************************


|**************** Bill of Lading Report Variable *********************************
table	ttdisg842
table	ttdisg843
table	ttdisg845
table	ttdisg831
table	ttdisg824
table	ttdisg865
table	ttpisg122	|#ISGEC017006.n


|* Report Handling Variables
extern	domain	tcmcs.long	detail,i
extern	domain	tcpono		srno,counter
extern	domain	tcamnt		deduction1,deduction2,deduction3,deduction4
extern	domain	tcorno		commercial_invoice
extern	domain	tcamnt		net_payable,tot_payable
extern	domain	tcmcs.str215	cash.str
extern	domain	tcmcs.str80	amt_str
extern	domain	tcmcs.str100	amt_str.inr, cash.str.inr


|****************************** Custom Invoice *******************************
function extern tdisgdll831tv.custom_invoice
					(
						domain	tcorno	i.edrn		|Billing Advice No.
					)
{
	long	print.stat
	
	domain tcmcs.long 	yr, mnth, day
	domain tcdate		o.eff.date
	domain tcratf		o.ratf
	domain tcyesno		o.yes.no.flag
	
	tcmcs.dll0095.read.parm("tccom000")
	curr.comp = get.compnr()		
	srno=0
	p = 0
	q = 0
	tot_amount = 0
	tot.inr.amnt = 0
	final.total = 0
	total.pack = 0
	companydetails()
	tccom130.nama=" "
	tccom130.namc=" "
	tccom130.dsca=" "
	tccom130.ln06=" "
	tccom130.pstc=" "
	lumpsum = "Lumpsum"
	cin.no.export = ""			
	iec.no.export = ""
	pan.no.export = ""
	tax.amnt = 0				|RAvi.a.07102020
	tot.inr.amnt.with.tax = 0		|RAvi.a.07102020
	invoice.line.count = 0			|RAvi.a.20102020
	ann.line.cal = 0			|RAvi.a.20102020
	tot.tax.amnt = 0			|RAvi.a
	
    text(1,1) = ""				
	text(1,2) = ""				
	
	heading = "EXPORT INVOICE"
	nill.val = "0.00"
	
	if curr.comp = 700 then				
		cin.no.export = "U29308HR2017PTC67285"
		iec.no.export = "AD090319001886S" 
		pan.no.export = "AAECI3897A"
	else
		cin.no.export = "L23423HR1933PL000097"
		iec.no.export = "0501013628" 
		pan.no.export = "AAACT5540K"
	endif
								
	select	tdisg831.*,tpisg036.*
	from	tdisg831,tpisg036
	where	tdisg831._index1 = {:i.edrn}
	and	tdisg831.cprj	refers	to	tpisg036
	selectdo
		select	tppdm740.ccur
		from	tppdm740
		where	tppdm740._index1 = {:tdisg831.cprj,:tdisg831.ofbp}
		selectdo
			select	tcmcs002.dsca
			from	tcmcs002
			where	tcmcs002._index1 = {:tppdm740.ccur}
			selectdo
			selectempty
				tcmcs002.dsca = ""
			endselect
		endselect
		
									
		if tdisg831.etyp = tdisg.advice.service then
			if date.to.num(2021, 06, 07) > tdisg831.invd then
				num.to.date(tdisg831.invd, yr, mnth, day)
				o.eff.date = date.to.utc(yr, mnth, day, 23 , 59, 59)
								
				if not tcmcs.dll0108.determine.currency.rate.and.rate.factor(	get.compnr(),
												"INR",
												tppdm740.ccur,
												o.eff.date,		
												"SAL",			
												exc.rate,		
												o.ratf,
												o.yes.no.flag)	 then	
				endif
			else
				exc.rate = tdisg831.etct
			endif		
			rate.type.line = 	"(RBI DAILY EXCHANGE RATE TAKEN FOR CONVERSION 1 " &
					tppdm740.ccur & " = " & trim$(str$(exc.rate)) & " INR)" 							
		else	
			if date.to.num(2021, 06, 07) > tdisg831.invd then
				select	tdisg878.exrt:exc.rate
				from	tdisg878
				where	tdisg878._index1 = {:tppdm740.ccur}
				and	tdisg878.efdt <= :tdisg831.invd
				and	tdisg878.appr = tcyesno.yes 
				selectdo
				selectempty
					exc.rate = 1
				endselect
			else
				exc.rate = tdisg831.etct
			endif
				
			rate.type.line = 	"(CUSTOM EXCHANGE RATE TAKEN FOR CONVERSION 1 " &
					tppdm740.ccur & " = " & trim$(str$(exc.rate)) & " INR)" 
		endif
									|#ISGEC017006.en
		get_label()
		select	tdisg839.blno,tdisg839.pddt, tdisg839.biln,
			tdisg839.voyg, tdisg839.vfln
		from	tdisg839
		where	tdisg839._index1 = {:tdisg831.bold}
		selectdo
		selectempty
			tdisg839.blno = ""
			tdisg839.pddt = 0
		endselect
		
		select	tpisg122.gstn.c,
			tpisg122.orno,
			tpisg122.podt
		from	tpisg122
		where	tpisg122._index1 = {:tdisg831.cprj}
		selectdo
		selectempty
			tpisg122.gstn.c = 0
			tpisg122.podt = 0
			tpisg122.orno = ""
		endselect

| 		tctax.dll9140.get.own.reg.number.based.on.seq(tpisg122.gstn.c, gstn.c.no)			|GH489CR000.com
		tctax.dll9140.get.own.reg.number.based.on.seq(tdisg831.rnso.l, gstn.c.no)			|GH489CR000.new
		
		description()
		select tccom130.*
		from	tccom130
		where	tccom130._index1 = {:tdisg831.fact}
		selectdo
			label.f = "Factory Address :"
			factory1 = tccom130.ln01
			factory2 = tccom130.ln02
			factory3 = tccom130.ln03
			factory4 = tccom130.ln04
			factory5 = tccom130.ln05
		selectempty
			label.f = ""
			factory1 = ""
			factory2 = ""
			factory3 = ""
			factory4 = ""
			factory4 = ""
			factory5 = ""
		endselect
		
		select	tpisg036.exad,tpisg036.exp3,tpisg036.exp4,tpisg036.head
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
			select tccom130.*
			from	tccom130
			where	tccom130._index1 = {:tpisg036.exad}
			selectdo
				exp1 = tccom130.ln01
				exp2 = tccom130.ln02
				exp3 = tccom130.ln03
				exp4 = tccom130.ln04
				exp5 = tccom130.ln05	
			selectempty
				exp1 = ""
				exp2 = ""
				exp3 = ""
				exp4 = ""
				exp5 = ""
			endselect
		endselect
		
		select	tdisg825.*
		from	tdisg825
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
			buyer_order = tdisg825.born
			buyer_date = tdisg825.bdat
			
			inco_term = tdisg825.inco
			mode = tdisg825.mpay
			buyer1 = tdisg825.buy1
			buyer2 = tdisg825.buyr2
			buyer3 = tdisg825.buy3
			buyer4 = tdisg825.buy4
			buyer5 = tdisg825.buy5
			
			con1 = tdisg825.con1
			con2 = tdisg825.con2
			con3 = tdisg825.con3
			con4 = tdisg825.con4
			con5 = tdisg825.con5
			tpisg036.head = tpisg036.head
			
			select	tcmcs041.dsca,tcmcs041.cdec
			from	tcmcs041
			where	tcmcs041._index1 = {:tdisg825.cdec}
			selectdo
				delivery_term = tcmcs041.cdec
			endselect
			
			term_delivery = delivery_term(1;3) & " " & trim$(tdisg831.ctyd) & " " & trim$(inco_term)
		selectempty
			select	tpisg036.*
			from	tpisg036
			where	tpisg036._index1 = {:tdisg831.cprj}
			selectdo
				buyer_order = tpisg036.born
				buyer_date = tpisg036.bdat
				
				inco_term = tpisg036.inco
				mode = tpisg036.mpay
				
				buyer1 = tpisg036.buyr1
				buyer2 = tpisg036.buyr2
				buyer3 = tpisg036.buyr3
				buyer4 = tpisg036.buyr4
				buyer5 = tpisg036.buyr5
				
				con1 = tpisg036.cons1
				con2 = tpisg036.cons2
				con3 = tpisg036.cons3
				con4 = tpisg036.cons4
				con5 = tpisg036.cons5
				
				select	tcmcs041.dsca,tcmcs041.cdec
				from	tcmcs041
				where	tcmcs041._index1 = {:tpisg036.cdec}
				selectdo
					delivery_term = tcmcs041.cdec
				endselect
				
				term_delivery = delivery_term(1;3) & " " & trim$(tdisg831.ctyd) & " " & trim$(inco_term)
			endselect
		endselect
		
		select	tdisg861.head
		from	tdisg861
		where	tdisg861._index1 = {:tdisg825.temp,:tdisg831.motp}
		selectdo
		selectempty
			tdisg861.head = ""
		endselect
		
		tot_amount = 0
		tot.inr.amnt = 0
		final.total = 0
		create.html.invoice.header()
		
		package_no_print()
				
		value_declare = ""
		
		select	tdisg832.*, tcibd001.cuni				
		from	tdisg832,tcibd001
		where	tdisg832._index1={:i.edrn}
		and	tdisg832.bivl <> 0
		and	tdisg832.item refers to tcibd001			
		selectdo
			tdisg832.tfcd = strip$(tdisg832.tfcd) & "B"		
			hsn.description1 = tdisg832.desc(1;50)
			hsn.description2 = tdisg832.desc(51;100)
			hsn.description3 = tdisg832.desc(101;150)
			hsn.description4 = tdisg832.desc(151;200)
			
			inr.amnt = tdisg832.bivl * exc.rate 
			get.tax.data()								|RAvi.a.07102020							
			tot_amount = tot_amount + tdisg832.bivl
			total.amnt.r = 	inr.amnt + tax.amnt
			tot.inr.amnt = tot.inr.amnt + inr.amnt
			tot.tax.amnt = tot.tax.amnt + tax.amnt
			tot.inr.amnt.with.tax = tot.inr.amnt.with.tax + total.amnt.r			|RAvi.a.07102020
			
			dbk_description1 = tdisg832.tfds(1;50)
			dbk_description2 = tdisg832.tfds(51;100)
			dbk_description3 = tdisg832.tfds(101;150)		
			dbk_description4 = tdisg832.tfds(151;200)		
			
			description1 = tdisg832.dsca(1;50)
			description2 = tdisg832.dsca(51;100)
			
			spacecall2(tdisg832.dsca)		
			
			nill.val = "0.00"
			if tdisg832.edbk <> tcyesno.yes then				
				tdisg832.tfcd = ""
				dbk_description1 = ""
				dbk_description2 = ""
				dbk_description3 = ""
				dbk_description4 = ""
			endif
											
			if tdisg832.tobi  = tcyesno.no then
				value_declare = ""
			else
				value_declare = "Value Declared for Custom Purpose Only"
			endif	
			
			q = 0
			select	tdisg876.efdt, tdisg876.lbno, tdisg876.type
			from	tdisg876
			where	tdisg876._index1 = {:tdisg831.lcod}
			selectdo
			selectempty
				tdisg876.efdt = 0
				tdisg876.lbno = ""
			endselect
		
| 			if isspace(tdisg831.cvat) then
			if not isspace(tdisg831.lcod) then
				lut.line = 	"EXPORT UNDER " & 
						trim$(enum.descr$("tdisg.sec.typ", tdisg876.type, "2")) &
						" No. " & trim$(tdisg876.lbno) & " DATED " &
						trim$(sprintf$("%D(%02d %-03H %04Y)", tdisg876.efdt)) & "."
			else
				lut.line = ""		
			endif
					
			invoice.line.count = invoice.line.count + 1
			create.invoice.lines()
			select	tdisg007.type:v.type,sum(tdisg007.nopk):v.nopk
			from	tdisg007
			where	tdisg007._index1 = {:tdisg832.rcno,:tdisg832.rcln}
			and	tdisg007.slct = tcyesno.yes
			group by tdisg007.type
			selectdo
				p = 4
				q = q + 1
| 				rprt_send()
| 				create.custom.inv.nos.line()
				print.stat = 1
				v.type = ""
				v.nopk = 0
				tdisg832.pcun = ""
				tdisg832.pqty = 0
				tdisg832.bivl = 0
				inr.amnt = 0
				tdisg832.code = ""
				nill.val = ""
				tdisg832.tfcd = ""
			selectempty
				p = 4
				q = q + 1
| 				rprt_send()
| 				create.custom.inv.nos.line()
			endselect
			
			srno = srno + 1
			get.amount.in.word1(tot_amount)
		selectempty
| 			value_declare = "Value Declared for Custom Purpose Only"
		endselect
		
| 		package_no_print()
	endselect
	p = 5
	
	rprt_send()
	
	p = 10
	
	dbk_des3 = tdisg825.info1			
	dbk_des5 = tdisg825.info2
	
	if tdisg832.edbk = tcyesno.yes then
| 		dbk_des1 = "WE HEREBY DECLARE THAT WE DO NOT HAVE ANY OBJECTION TO THE DRAWBACK BENEFIT BEING"		
| 		dbk_des2 = "RESTRICTED BASED ON 150% VALUE OF TAX INVOICE OF VENDOR OR FOB VALUE WHICHEVER IS LOWER"	
		dbk_des4 = "END USE CODE - GNX200"
		
		date.280520 = date.to.num(2020, 05, 28)									
		if tdisg831.invd < date.280520 and tdisg831.invd <> 0 then
			dbk_des6 = "WE HEREBY DECLARE THAT WE DO NOT HAVE ANY OBJECTION TO THE DRAWBACK BENEFIT RESTRICTED"		
			dbk_des7 = "BASED ON 150% VALUE OF TAX INVOICE OF VENDOR OR FOB VALUE WHICHEVER IS LOWER"		
			dbk_des8 = ""
			dbk_des9 = ""
		else
			dbk_des6 = "WE HEREBY REQUEST CUSTOMS DEPARTMENT TO RELEASE DUTY DRAWBACK AS PER "		
			dbk_des7 = "GOVERNMENT POLICY AND RULES OF DUTY DRAWBACK SCHEME APPLICABLE TO US. "			
			dbk_des8 = "FURTHER DECLARE WE DO NOT HAVE ANY OBJECTION IF DBK AMOUNT IS RESTRICTED"				
			dbk_des9 = "UNDER ANY PROVISION OF DBK RULES."				
		endif													
	else										
		dbk_des1 = ""
		dbk_des2 = ""
		dbk_des4 = ""
		dbk_des6 = ""	
		dbk_des7 = ""	
		dbk_des8 = ""	
		dbk_des9 = ""	
	endif	
	
	if tdisg832.efms = tcyesno.yes then
| 		meis.des1 = "WE INTEND TO CLAIM REWARDS UNDER MERCHANDISE EXPORTS FROM INDIA SCHEME (MEIS)"			|RAvi.a.s.04012021
| 		meis.des2 = "ALSO REWARD SCHEME MUST BE TICKED YES"
		meis.des1 = "WE INTEND TO CLAIM REWARDS UNDER REMISSION OF DUTIES AND TAXES ON EXPORTED"
		meis.des2 = " PRODUCTS(RoDTEP) SCHEME."			
		meis.des3 = "ALSO REWARD SCHEME MUST BE TICKED YES"					|RAvi.a.s.04122021
	else
		meis.des1 = ""
		meis.des2 = ""
	endif
													|ISGEC01092.en
	
| 	if isspace(tdisg831.cvat) then
	if not isspace(tdisg831.lcod) then
		term.line = "SUPPLY MEANT FOR EXPORT UNDER LETTER OF UNDERTAKING WITHOUT PAYMENT OF INTEGERATED TAX"
	else
		term.line = "SUPPLY MEANT FOR EXPORT ON PAYMENT OF INTEGRATED TAX"
	endif
	
	rprt_send()
	create.html.we.intend()
	p = 15
	
	sum.lc.amnt = 0.00
	sum.lc.amnt.inr = 0.00
	
	select	tdisg860.desc:net.payable.line
	from	tdisg860
	where	tdisg860._index1 = {:tdisg831.lcno}
	and	tdisg860.ptyp = tdisg.ptyp.netpay
	selectdo
	selectempty
		net.payable.line = ""
	endselect
	
	select	tdisg860.desc, tdisg860.pval
	from	tdisg860
	where	tdisg860._index1 = {:tdisg831.lcno}
	and	tdisg860.ptyp <> tdisg.ptyp.netpay
	selectdo
		lc.amnt = (tot_amount * tdisg860.pval) / 100
		lc.amnt.inr = (tot.inr.amnt * tdisg860.pval) / 100
		sum.lc.amnt = sum.lc.amnt + lc.amnt
		sum.lc.amnt.inr = sum.lc.amnt.inr + lc.amnt.inr
		rprt_send()
		create.html.amount.total()
	endselect
	
	p = 18
	final.total = tot_amount - sum.lc.amnt
	tot.inr.amnt = round(tot.inr.amnt, 2, 0)
	tot.inr.amnt.with.tax = round(tot.inr.amnt.with.tax, 2, 0)					|RAvi.a.12102020
	tot.tax.amnt = round(tot.tax.amnt, 2, 0)					|RAvi.a.12102020
	sum.lc.amnt.inr = round(sum.lc.amnt.inr, 2, 0)
	final.total.inr = tot.inr.amnt - sum.lc.amnt.inr
	rprt_send()
	amt_str = ""
	amt_str.inr = ""
	cash.str = ""
	cash.str.inr = ""
	
	tfgld.dll9998.in.words(final.total,amt_str)
	amt_str = toupper$(amt_str)
	
	tfgld.dll9999.1.in.words(final.total.inr,amt_str.inr)	
	amt_str.inr = toupper$(amt_str.inr)
	
	tfgld.dll9998.in.words(tot_amount,cash.str)
	cash.str = toupper$(cash.str)
	
	tfgld.dll9999.1.in.words(tot.inr.amnt,cash.str.inr)
	cash.str.inr = toupper$(cash.str.inr)
	create.final.html.invoice()
	
	p = 0
	
	print.annexure()	
}

function print.annexure()
{
	domain	tfgld.docn	g.ninv, ninv.array(20)
	domain	tcbool		IR.is.printed
	domain	tcyesno		o.tfacp100.cdf_gstr
		long		m, n, brp.id
	
| 	brp.id = brp.open("rtdisg84310100a", "PL", 0)
	
	repeat.flag = 0			
	m = 0
	o.srno = 0
	IR.is.printed = false
							|#CR458.sn
	r.var.vhno = ""
	var.dino = 0
	i.vhno = 1	
							|#CR458.en
	for n = 1 to 20
		ninv.array(n) = 0 
	endfor

	create.annexure.export.header()
	select	tdisg832.rcno						
	from	tdisg832
	where	tdisg832._index1 = {:tdisg831.edrn}
	and 	tdisg832.rcno <> ""
	group by tdisg832.rcno
	selectdo
		select	whinh310.dino
		from	whinh310
		where	whinh310._index1 = {:tdisg832.rcno}
		selectdo
			g.ninv = lval(whinh310.dino)
			
			if g.ninv = 0 then
				continue
			endif
			
			for n = 1 to m 
				if ninv.array(n) = g.ninv then
					IR.is.printed = true
					break 
				endif
			endfor
			
			if IR.is.printed then
				continue
			endif
			
			m = m + 1
			ninv.array(m) = g.ninv
			
			select	tfacp100.isup, tfacp100.invd, tfacp100.ifbp,
				tccom100.nama, tfacp100.cdf_gstr, tccom100.cadr			|GH524CR000.a
			from	tfacp100, tccom100
			where	tfacp100._index1 = {:g.ninv}
			and	tfacp100.ifbp refers to tccom100 UNREF CLEAR
			selectdo
				select	tfisg405.gstn.b
				from	tfisg405
				where	tfisg405._index1 = {:g.ninv}
				selectdo
				selectempty
					tfisg405.gstn.b = 0
				endselect
				get.var(pid, "tfacp100.cdf_gstr", o.tfacp100.cdf_gstr)
				tctax.dll4100.get.bp.reg.number.based.on.seq.l(tfisg405.gstn.b, gstn.b.no)
			selectempty
				tfacp100.isup = ""
				tfacp100.invd = 0
				tfacp100.ifbp = ""
				tccom100.nama = ""
				gstn.b.no = ""
				o.tfacp100.cdf_gstr = tcyesno.no
			endselect
			
			p.line = (o.tfacp100.cdf_gstr = tcyesno.no) ? "Tax Invoice not Received from Supplier":""
			
			o.srno = o.srno + 1
													
			var.dino = lval(trim$(whinh310.dino))
			select	tfisg003.vhno
			from	tfisg003
			where	tfisg003._index3 = {:var.dino}
			selectdo
				if i.vhno = 1 then
					r.var.vhno = trim$(tfisg003.vhno)
				else
					r.var.vhno = r.var.vhno & ", " & trim$(tfisg003.vhno)
					r.var.vhno = trim$(r.var.vhno)
				endif 
				i.vhno = i.vhno + 1
			endselect
					
			select	tccom130.nama,						|GH524CR000.a.s
				tccom130.namb
			from	tccom130
			where	tccom130._index1 = {:tccom100.cadr}
			as set with 1 rows
			selectdo
				vender.name.cadr = trim$(tccom130.nama) & " " & trim$(tccom130.namb)
			selectempty
				vender.name.cadr = ""
			endselect							|GH524CR000.a.e
| 			brp.ready(brp.id)
			create.annexure.export.line()
		endselect
		IR.is.printed = false  		
	endselect	
	create.annexure.footer()
}

function package_no_print()
{
	select	tdisg864.type
	from	tdisg864
	selectdo
		tot.nopk = 0
		select	tdisg832.rcno,tdisg832.rcln				
		from	tdisg832
		where	tdisg832._index1 = {:tdisg831.edrn}
		selectdo
			select	tdisg007.type,sum(tdisg007.nopk):tmp.nopk
			from	tdisg007
			where	tdisg007._index1 = {:tdisg832.rcno,:tdisg832.rcln}
			and	tdisg007.type = :tdisg864.type
			and	tdisg007.slct = tcyesno.yes
			group by tdisg007.type
			selectdo
			selectempty
				tmp.nopk = 0
			endselect
			tot.nopk = tot.nopk + tmp.nopk
		endselect
		if	tot.nopk <> 0	then
			q = 0
			p = 1
			total.pack = total.pack + tot.nopk
			create.custom.inv.nos.line()
| 			rprt_send()			
		endif	
	endselect
	q = 0
	p = 2
	total.pack = total.pack
| 	rprt_send()
	create.custom.inv.nos.line.total()
}

function package_no_print_commercial()
{
	select	tdisg864.type
	from	tdisg864
	selectdo
		tot.nopk = 0
		select	tdisg832.rcno,tdisg832.rcln					
		from	tdisg832
		where	tdisg832._index3 = {:tdisg831.cinv}
		selectdo
			select	tdisg007.type,sum(tdisg007.nopk):tmp.nopk
			from	tdisg007
			where	tdisg007._index1 = {:tdisg832.rcno,:tdisg832.rcln}
			and	tdisg007.type = :tdisg864.type
			and	tdisg007.slct = tcyesno.yes
			group by tdisg007.type
			selectdo
			selectempty
				tmp.nopk = 0
			endselect
			tot.nopk = tot.nopk + tmp.nopk
		endselect
		if	tot.nopk <> 0	then
			q = 0
			p = 1
			total.pack = total.pack + tot.nopk
| 			rprt_send()
			create.com.inv.nos.line()
		endif	
	endselect
	create.com.inv.nos.line.total()
	q = 0
	p = 2
	total.pack = total.pack
	rprt_send()
}

|Get Label

function	get_label()
{
	if not isspace(tdisg831.lcno) then
		select	tdisg825.temp
		from	tdisg825
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
        selectempty						
			tdisg825.temp = ""				
		endselect
		select	tdisg861.com1,tdisg861.com2,tdisg861.com3,
			tdisg861.com4,tdisg861.com5,tdisg861.com6,
			tdisg861.com7,tdisg861.com8,tdisg861.com9,
			tdisg861.com10,tdisg861.com11,tdisg861.com12,
			tdisg861.com13,tdisg861.com14,tdisg861.com15,
			tdisg861.com16,tdisg861.com17,tdisg861.com18,
			tdisg861.com19,tdisg861.com20,tdisg861.fval,
			tdisg861.lprc,tdisg861.lfre,tdisg861.lins,
			tdisg861.cust1,tdisg861.cust2,tdisg861.cust3,
			tdisg861.cust4,tdisg861.cust5,tdisg861.cust6,
			tdisg861.cust7,tdisg861.cust8,tdisg861.text
		from	tdisg861
		where	tdisg861._index1 = {:tdisg825.temp,:tdisg831.motp}
		selectdo
			text.to.buf("tdisg861.text","2",2,text)
			for xyz = 1 to 2
				if	xyz = 1	then
					text1 = text(1,xyz)
				else	
					text2 = text(1,xyz)
				endif	
			endfor
          selectempty
			      text1 = ""					
			      text2 = ""					
		endselect
	else
		select	tpisg036.temp
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
		endselect
		
		select	tdisg861.com1,tdisg861.com2,tdisg861.com3,
			tdisg861.com4,tdisg861.com5,tdisg861.com6,
			tdisg861.com7,tdisg861.com8,tdisg861.com9,
			tdisg861.com10,tdisg861.com11,tdisg861.com12,
			tdisg861.com13,tdisg861.com14,tdisg861.com15,
			tdisg861.com16,tdisg861.com17,tdisg861.com18,
			tdisg861.com19,tdisg861.com20,tdisg861.fval,
			tdisg861.lprc,tdisg861.lfre,tdisg861.lins,
			tdisg861.cust1,tdisg861.cust2,tdisg861.cust3,
			tdisg861.cust4,tdisg861.cust5,tdisg861.cust6,
			tdisg861.cust7,tdisg861.cust8,tdisg861.text
		from	tdisg861
		where	tdisg861._index1 = {:tpisg036.temp,:tdisg831.motp}
		selectdo
			text.to.buf("tdisg861.text","2",2,text)
			for xyz = 1 to 2
				if	xyz = 1	then
					text1 = text(1,xyz)
				else	
					text2 = text(1,xyz)
				endif	
			endfor
                       selectempty
	                        		text1 = ""				
		                         	text2 = ""				
		endselect
	endif	
}

function description()
{
	select tpisg037.desc
	from	tpisg037
	where	tpisg037._index1 = {:tdisg831.ptld}
	selectdo
		desc = tpisg037.desc
	endselect
	
	select tpisg037.desc
	from	tpisg037
	where	tpisg037._index1 = {:tdisg831.ptds}
	selectdo
		desc1 = tpisg037.desc
	endselect

	select tpisg037.desc
	from	tpisg037
	where	tpisg037._index1 = {:tpisg036.pldv}
	selectdo
		desc2 = tpisg037.desc
	endselect

	select tcmcs010.dsca
	from	tcmcs010
	where	tcmcs010._index1={:tdisg831.octy}
	selectdo
		desc3= tcmcs010.dsca
	selectempty
		desc3 = " "
		tcmcs010.dsca=" "	
	endselect	
		
	if not isspace(tdisg831.lcno) then
		select	tdisg825.ccty
		from	tdisg825	
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
			select tcmcs010.dsca
			from	tcmcs010
			where	tcmcs010._index1={:tdisg825.ccty}
			selectdo
				desc4 = tcmcs010.dsca
			selectempty
				desc4 =" "
				tcmcs010.dsca=" "		
			endselect
		endselect
	else
		select	tpisg036.cofd
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
			select tcmcs010.dsca
			from	tcmcs010
			where	tcmcs010._index1={:tpisg036.cofd}
			selectdo
				desc4 = tcmcs010.dsca
			selectempty
				desc4 =" "
				tcmcs010.dsca=" "		
			endselect	
		endselect
	endif	
}

|Get Amount in Words.

function  get.amount.in.word1(domain tcamnt tot.amth)	
{
	double	decc	

	long temp
	
	v.lacs = ""
	
	lac=tot.amth/100000
	
	tcmcs.dll0006.decode(lac,2,decode0,decode1,decode2,decode3,"2")
	lacs=decode0
	if isspace(lacs) or lacs="zero" then
		v.lacs = ""
	else
		v.lacs = "LAC"
	endif
	
	tot.amth=tot.amth\100000
	
	tcmcs.dll0006.decode(tot.amth,2,decode0,decode1,decode2,decode3,"2")
   
	decc = lval(decode3)*1
	tcmcs.dll0006.decode(decc,2,decode4,decode5,decode6,decode7,"2")

	if decc<>0  then
		r.word1 = toupper$(strip$(lacs)) & " " & toupper$(strip$(shiftl$(v.lacs))) & " "& toupper$(strip$(decode0) & " and " & strip$(decode4) & " Paise")

	else    if lac>=0 and tot.amth<>0 then
		r.word1 = toupper$(strip$(lacs)) & " "& toupper$(strip$(shiftl$(v.lacs)))  & " "& toupper$(strip$(decode0)) & " " & "ONLY"
	else
		r.word1=toupper$(strip$(lacs)) & " "& toupper$(strip$(shiftl$(v.lacs)))  & "  " & "ONLY"
	endif
	endif
}

|Company Details
function companydetails()
{
	tcmcs.dll0095.read.parm("tccom000")
	
	select tccom130.*
	from	tccom130
	where	tccom130._index1 = {:tccom000.cadr}
	selectdo
		nama	= tccom130.nama
		line	= tccom130.namc
		line5	= tccom130.dsca
		line6	= tccom130.ln06
		line7	= tccom130.pstc
	selectempty
		nama	=""
		line	= ""
		line5	= ""
		line6	= ""
		tccom130.nama=""
		tccom130.namc=""
		tccom130.dsca=""
		tccom130.ln06=""
		tccom130.pstc=""
	endselect	
}

|GET INSURANCE FREIGHT VALUE FOR COMMERCIAL PACKING LIST
function	get_insurance_freight1()
{
	i.fob.amount = i.fob.amount + tdisg831.fovv
		
	i.freight = i.freight + tdisg831.frgt

	i.insurance = i.insurance + tdisg831.insu
	p = 4
	rprt_send()
}

 function spaceCall(domain tcmcs.str50 word)		|#ISGEC01031.sn
{
	long	i, last
	
	last = 0
	description3 = ""
	FOR i = 1 TO 50 step 1	
		if word(i;1) = " "  then
			
			last = i
		endif
	ENDFOR
	if last < 50 and last >= 40 then
		description3 = tpisg031.dsca(last;60)
		tpisg031.dsca = tpisg031.dsca(1;last)
	
	endif
 
}
function spaceCall1(domain tcmcs.str50 word)
{
	long	i, last
	
	last = 0
| 	description2 = ""		|#ISGEC01518.n
| 	dbk_description2 = ""		|#ISGEC01518.n
	FOR i = 1 TO 50 step 1	
		if word(i;1) = " "  then
			
			last = i
		endif
	ENDFOR
	if last < 50 and last >= 40 then
		dbk_description2 = tdisg832.tfds(last;60)
		dbk_description1= tdisg832.tfds(1;last)
	
	endif
 
}						|#ISGEC01031.en





function spacecall2(domain tcmcs.str50 word1)		|#ISGEC01518.sn
{
	long	i, last
	
	last = 0
	description2 = ""		

	FOR i = 1 TO 50 step 1	
		if word1(i;1) = " "  then
			
			last = i
		endif
	ENDFOR
	if last <= 50 and last >= 20 then
		description2 = strip$(tdisg832.dsca(last;60))
		description1= tdisg832.dsca(1;last)
	endif
	if last = 0 then
		description1 = tdisg832.dsca(1;50)
		description2 = tdisg832.dsca(51;100)
	endif
	
}						

function get.emp.nama(domain tcemno i.emno, ref domain tcnama o.e.nama)
{
	select	tccom001.nama:o.e.nama
	from	tccom001
	where	tccom001._index4 = {:i.emno}
	selectdo
	selectempty
		o.e.nama = ""	
	endselect
}

|****************COMMERCIAL INVOICE REPORT FUNCTION START *************************************
|COMMERCIAL INVOICE ***************************************************************************
function extern tdisgdll831tv_commercial_invoice
						(
							domain	tcorno	i.cinv
						)
{
	|* Function for printing report for Commercial Invoice.
	
	domain	tccom.cadr	o.cadr.bpid,o.cadr.cons
	total.pack = 0
	custom_invoice = ""
	initialize()
	
	get.exporter.details()
	
	lumpsum = "Lumpsum"
	
	i.heading = "COMMERCIAL INVOICE"
	
	select	tdisg831.bpid,tdisg831.cprj,tdisg831.invn,
		tdisg831.fovv,tdisg831.frgt,tdisg831.insu,
		tdisg831.ofbp,tdisg831.cinv,tdisg831.lcno,
		tdisg831.motp,tdisg831.xref
	from	tdisg831
| 	where	tdisg831._index3 = {:tdisg831.cinv}
	where	tdisg831._index3 = {:i.cinv}
	selectdo
		select	tppdm740.ccur
		from	tppdm740
		where	tppdm740._index1 = {:tdisg831.cprj,:tdisg831.ofbp}
		selectdo
			select	tcmcs002.dsca
			from	tcmcs002
			where	tcmcs002._index1 = {:tppdm740.ccur}
			selectdo
			selectempty
				tcmcs002.dsca = ""
			endselect
		endselect	
		get_label_commercial()
		description()
		select	tpisg036.exad,tpisg036.exp1,tpisg036.exp2,tpisg036.head,tpisg036.txta
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
			
| 				text.to.buf("tpisg036.txta","2",2,text)
| 				for xyz = 1 to 2
| 					if	xyz = 1	then
| 						text1 = text(1,xyz)
| 					else	
| 						text2 = text(1,xyz)
| 					endif	
| 				endfor	
			
		endselect
		
		if not isspace(tdisg831.invn) then
			get.cust.invn(tdisg831.cinv)
		endif
		
		if not isspace(tdisg831.invn) then
			all.our.ref = all.our.ref & tdisg831.invn & ","
		endif
		
		if isspace(i.bpid.dsca) and isspace(i.cons.dsca) 
			and	i.first.customer
		then
			get.address.lines(
				o.cadr.bpid,
				i.bp.ln01,
				i.bp.ln02,
				i.bp.ln03,
				i.bp.ln04)

			i.first.customer = false
		endif
				
		if first.call then
			fetch.data.from.tpisg036(tdisg831.cprj)
			
			|* fetch % for Advance
			fetch.percentage(
				tdisg831.cprj,
				tdisg.ptyp.advance,
				o.total.adv.perc)
			
			|* fetch % for retention
			fetch.percentage(
				tdisg831.cprj,
				tdisg.ptyp.retention,
				o.total.ret.perc)
					
			first.call = false
		endif
		
		select	tdisg825.*
		from	tdisg825
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
			inco_term = tdisg825.inco
			mode = tdisg825.mpay
			
			exp1 = tdisg825.exp1
			exp2 = tdisg825.exp2
			exp3 = tdisg825.exp3
			exp4 = tdisg825.exp4
			exp5 = tdisg825.exp5
			
			goods1 = tdisg825.des1
			goods2 = tdisg825.des2
			goods3 = tdisg825.des3
			goods4 = tdisg825.des4
			goods5 = tdisg825.des5
			goods6 = tdisg825.des6
			
			buyer1 = tdisg825.buy1
			buyer2 = tdisg825.buyr2
			buyer3 = tdisg825.buy3
			buyer4 = tdisg825.buy4
			buyer5 = tdisg825.buy5
			
			con1 = tdisg825.con1
			con2 = tdisg825.con2
			con3 = tdisg825.con3
			con4 = tdisg825.con4
			con5 = tdisg825.con5
			
			select	tcmcs041.cdec,tcmcs041.dsca
			from	tcmcs041
			where	tcmcs041._index1 = {:tdisg825.cdec}
			selectdo
				delivery_term = tcmcs041.cdec
			endselect
			term_delivery = delivery_term(1;3) & " " & trim$(tdisg831.ctyd) & " " & trim$(inco_term)
		selectempty
			select	tpisg036.*
			from	tpisg036
			where	tpisg036._index1 = {:tdisg831.cprj}
			selectdo
				inco_term = tpisg036.inco
				mode = tpisg036.mpay
				
				exp1 = tpisg036.exp5
				exp2 = tpisg036.exp6
				exp3 = tpisg036.exp7
				exp4 = tpisg036.exp8
				exp5 = tpisg036.exp9
				
				goods1 = tpisg036.good1
				goods2 = tpisg036.good2
				goods3 = tpisg036.good3
				goods4 = tpisg036.good4
				goods5 = tpisg036.good5
				goods6 = tpisg036.good6
				
				buyer1 = tpisg036.buyr1
				buyer2 = tpisg036.buyr2
				buyer3 = tpisg036.buyr3
				buyer4 = tpisg036.buyr4
				buyer5 = tpisg036.buyr5
				
				con1 = tpisg036.cons1
				con2 = tpisg036.cons2
				con3 = tpisg036.cons3
				con4 = tpisg036.cons4
				con5 = tpisg036.cons5
				
				select	tcmcs041.cdec,tcmcs041.dsca
				from	tcmcs041
				where	tcmcs041._index1 = {:tpisg036.cdec}
				selectdo
					delivery_term = tcmcs041.cdec
				endselect
				term_delivery = delivery_term(1;3) & " " & trim$(tdisg831.ctyd) & " " & trim$(inco_term)
			endselect
		endselect
	endselect
	tot_nwgt = 0
	tot_gwgt = 0
	create.html.com.invoice.header()
	package_no_print_commercial()
	select	tdisg832.qnty,tdisg832.slrt,tdisg832.bivl,
		tdisg832.pkgn,tdisg832.item,tdisg832.ninc,
		tdisg832.nwgt,tdisg832.gwgt,tdisg832.pqty,tdisg832.dsca,
		tdisg832.pcun,tcibd001.dsca,
		tcibd001.cuni
	from	tdisg832,tcibd001
	where	tdisg832._index3 = {:tdisg831.cinv}
	and	tdisg832.bivl <> 0
	and	tdisg832.item refers to tcibd001 UNREF CLEAR
	selectdo
		i.advance.payment = 0.00
		i.ret.payment = 0.00
		
		tot_nwgt = tot_nwgt + tdisg832.nwgt
		tot_gwgt = tot_gwgt + tdisg832.gwgt
		
		srno = srno + 1
		i.total.fob = i.total.fob + tdisg832.bivl
		i.total.cif = i.total.fob - (tdisg831.ded1 + tdisg831.ded2)
		i.advance.payment = (i.total.fob * o.total.adv.perc)/100
		
		i.ret.payment = (i.total.fob * o.total.ret.perc)/100
		
		select	tpisg031.dsca,tpisg031.txta
		from	tpisg031
		where	tpisg031._index1 = {:tdisg831.cprj,:tdisg831.ofbp,:tdisg832.ninc}
		selectdo
			spaceCall(tpisg031.dsca)		|#ISGEC01031.n
		selectempty
			tpisg031.dsca = tdisg832.dsca
			description3 = tpisg031.dsca(51;100)	|#ISGEC01031.n
		endselect
		
		p = 3
| 		rprt_send()
		create.com.invoice.lines()
	endselect
	
| 	create.com.invoice.lines()
	get_insurance_freight()
	get_payment_break_up()
	template()
	
	p = 4
| 	rprt_send()
	create.final.html.com.invoice()
	p = 0
}

|INITIALIZATION
function initialize()
{
	srno = 0
	i.bpid.dsca = ""
	i.cons.dsca = ""
	i.origin.ccty = ""
	i.dest.ccty = ""
	first.call = true
	i.first.customer = true
	i.total.cif = 0.00
	i.total.fob = 0.00
	i.fob.amount = 0.00
	i.insurance = 0.00
	i.freight = 0.00
	i.advance.payment = 0.00
	i.ret.payment = 0.00
	o.total.adv.perc = 0.00
	o.total.ret.perc = 0.00
}

|GET EXPORTER DETAILS 

function get.exporter.details()
{
	domain	tccomp	i.current.company
	i.current.company = get.compnr()
	
	tcmcs.dll0095.read.parm("tccom000",
				i.current.company)
				
	get.address.lines(
		tccom000.cadr,
		i.exp.ln01,
		i.exp.ln02,
		i.exp.ln03,
		i.exp.ln04)
}

|GET LABEL FOR COMMERCIAL

function	get_label_commercial()
{
	if not isspace(tdisg831.lcno) then
		select	tdisg825.temp
		from	tdisg825
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
		endselect
		select	tdisg861.com1,tdisg861.com2,tdisg861.com3,
			tdisg861.com4,tdisg861.com5,tdisg861.com6,
			tdisg861.com7,tdisg861.com8,tdisg861.com9,
			tdisg861.com10,tdisg861.com11,tdisg861.com12,
			tdisg861.com13,tdisg861.com14,tdisg861.com15,
			tdisg861.com16,tdisg861.com17,tdisg861.com18,
			tdisg861.com19,tdisg861.com20,tdisg861.fval,
			tdisg861.lprc,tdisg861.lfre,tdisg861.lins,tdisg861.text
		from	tdisg861
		where	tdisg861._index1 = {:tdisg825.temp,:tdisg831.motp}
		selectdo
			text.to.buf("tdisg861.text","2",2,text)
			for xyz = 1 to 2
				if	xyz = 1	then
					text1 = text(1,xyz)
				else	
					text2 = text(1,xyz)
				endif	
			endfor
		endselect
	else
		select	tpisg036.temp
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
		endselect
		
		select	tdisg861.com1,tdisg861.com2,tdisg861.com3,
			tdisg861.com4,tdisg861.com5,tdisg861.com6,
			tdisg861.com7,tdisg861.com8,tdisg861.com9,
			tdisg861.com10,tdisg861.com11,tdisg861.com12,
			tdisg861.com13,tdisg861.com14,tdisg861.com15,
			tdisg861.com16,tdisg861.com17,tdisg861.com18,
			tdisg861.com19,tdisg861.com20,tdisg861.fval,
			tdisg861.lprc,tdisg861.lfre,tdisg861.lins,tdisg861.text
		from	tdisg861
		where	tdisg861._index1 = {:tpisg036.temp,:tdisg831.motp}
		selectdo
			text.to.buf("tdisg861.text","2",2,text)
			for xyz = 1 to 2
				if	xyz = 1	then
					text1 = text(1,xyz)
				else	
					text2 = text(1,xyz)
				endif	
			endfor
		endselect
	endif	
}

|GET CUSTOM INVOICE FOR MULTIPLE CUSTOM INVOICE NO. PRINT 
function get.cust.invn	(
			domain	tcorno		i.cinv
			)
{
	long	zz
	i = 0
	for i = 1 to 7
		custom.invoice(1,i) = ""
	endfor 
	
	i = 1
	zz = 0
	
	select tdisg831.invn
	from	tdisg831
	where	tdisg831._index3 = {:i.cinv}
	as set with 21 rows
	selectdo
		zz = zz + 1
		on case zz
		case 1: 
			custom.invoice(1,i) = trim$(tdisg831.invn)
		break
		case 2: 
			custom.invoice(1,i) = trim$(custom.invoice(1,i)) & ", "& trim$(tdisg831.invn)
		break
		case 3: 
			custom.invoice(1,i) = trim$(custom.invoice(1,i)) & ", "& trim$(tdisg831.invn)
			i = i + 1
			zz = 0
		break
		ENDCASE  
	 endselect
}
|GET ADDRESS
function get.address.lines
	(
		domain	tccom.cadr	i.cadr,
	ref	domain	tcmcs.str100m	i.ln01,
	ref	domain	tcmcs.str100m	i.ln02,
	ref	domain	tcmcs.str100m	i.ln03,
	ref	domain	tcmcs.str100m	i.ln04
	)
{
	select	tccom130.ln01:i.ln01,
		tccom130.ln01:i.ln02,
		tccom130.ln01:i.ln03,
		tccom130.ln01:i.ln04
	from	tccom130
	where	tccom130._index1 = {:i.cadr}
	selectdo
	selectempty
		i.ln01 = ""
		i.ln02 = ""
		i.ln03 = ""
		i.ln04 = ""
	endselect
}
|FETCH PERCENATGE
function fetch.percentage
	(
		domain	tccprj		i.cprj,
		domain	tdisg.ptyp	i.type,
	ref	domain	tcdisc		o.perc
	)
{
	select	sum(tdisg824.pval):o.perc
	from	tdisg824
	where	tdisg824._index1 = {:i.cprj}
	and	tdisg824.ptyp = :i.type
	selectdo
	selectempty
		o.perc = 0.00
	endselect
}

|GET INSURANCE FREIGHT VALUE
function	get_insurance_freight()
{
	i.fob.amount = i.fob.amount + tdisg831.fovv
		
	i.freight = i.freight + tdisg831.frgt

	i.insurance = i.insurance + tdisg831.insu
	
	if not isspace(tdisg831.lcno) then
		select	tdisg825.temp
		from	tdisg825
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
		endselect
		
		select	tdisg861.head,tdisg861.fval,tdisg861.lfre,tdisg861.lprc,tdisg861.pfob,tdisg861.ltva
		from	tdisg861
		where	tdisg861._index1 = {:tdisg825.temp,:tdisg831.motp}
		selectdo
		selectempty
			tdisg861.head = ""
		endselect
	else
		select	tpisg036.temp
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
		endselect
		
		select	tdisg861.head,tdisg861.fval,tdisg861.lfre,tdisg861.lprc,tdisg861.pfob,tdisg861.ltva
		from	tdisg861
		where	tdisg861._index1 = {:tpisg036.temp,:tdisg831.motp}
		selectdo
		selectempty
			tdisg861.head = ""
		endselect	
	endif
	
	p = 5
| 	rprt_send()
	create.com.invoice.total.lines()
}

|GET TEMPLATE INFORMATION

function	template()
{
	if not isspace(tdisg831.lcno) then
		select	tdisg825.temp
		from	tdisg825
		where	tdisg825._index1 = {:tdisg831.lcno}
		selectdo
		endselect
		
		select	tdisg861.head,tdisg861.ltva
		from	tdisg861
		where	tdisg861._index1 = {:tdisg825.temp,:tdisg831.motp}
		selectdo
		selectempty
			tdisg861.head = ""
		endselect
		p = 6
		rprt_send()
	else
		select	tpisg036.temp
		from	tpisg036
		where	tpisg036._index1 = {:tdisg831.cprj}
		selectdo
		endselect
		
		select	tdisg861.head,tdisg861.ltva
		from	tdisg861
		where	tdisg861._index1 = {:tpisg036.temp,:tdisg831.motp}
		selectdo
		selectempty
			tdisg861.head = ""
		endselect
| 		p = 5
		p = 6
		create.com.invoice.total.lines()
| 		rprt_send()	
	endif	
}

|FETCH DATA FROM tpisg036
function fetch.data.from.tpisg036
	(
		domain	tccprj	i.cprj
	)
{
	select	tpisg036.pold,tpisg036.coor,tpisg036.cofd,
		tpisg036.xref|,tpisg036.cons
	from	tpisg036
	where	tpisg036._index1 = {:i.cprj}
	selectdo
		get.county.descritption(tpisg036.coor,
					i.origin.ccty
					)
		get.county.descritption(tpisg036.cofd,
					i.dest.ccty
					)
	selectempty
		tpisg036.coor = ""
		tpisg036.cofd = ""
		tpisg036.pold = ""
		i.origin.ccty = ""
		i.dest.ccty = ""
		tpisg036.xref = ""
	endselect
}

|GET PAYMENT BREAKUP
function	get_payment_break_up()
{
	domain	tcpono	v.ptcd
	if not isspace(tdisg831.lcno) then
		v.ptcd = 0
		get.max.ptcd(tdisg831.cinv,tdisg831.lcno,v.ptcd)
		select	tdisg865.ptcd,tdisg865.amnt,tdisg865.desc
		from	tdisg865
		where	tdisg865._index1 = {:tdisg831.cinv,:tdisg831.lcno}
		selectdo
| 			p = 6
			p = 7
			get.amount.in.word1(tdisg865.amnt)
			if v.ptcd > tdisg865.ptcd then
				create.com.invoice.total.lines1()
| 				rprt_send()
			endif	
			
		endselect
	else
		v.ptcd = 0
		get.max.ptcd(tdisg831.cinv,tdisg831.cprj,v.ptcd)
		select	tdisg865.ptcd,tdisg865.amnt,tdisg865.desc
		from	tdisg865
		where	tdisg865._index1 = {:tdisg831.cinv,:tdisg831.cprj}
		selectdo
| 			p = 6
			p = 7
			get.amount.in.word1(tdisg865.amnt)
			if v.ptcd > tdisg865.ptcd then
				create.com.invoice.total.lines1()
| 				rprt_send()
			endif
		selectempty
				
		endselect
	endif		
			
}

function get.county.descritption
	(
		domain	tcccty	i.ccty,
	ref	domain	tcdsca	i.dsca	
	)
{
	select	tcmcs010.dsca:i.dsca
	from	tcmcs010
	where	tcmcs010._index1 = {:i.ccty}
	selectdo
	selectempty
		i.dsca = ""
	endselect
}

function get.max.ptcd	(
			domain	tcorno	i.cinv,
			domain	tcorno	i.lcno,
		ref	domain	tcpono	v.ptcd
			)
{
	select	max(tdisg865.ptcd):v.ptcd
	from	tdisg865
	where	tdisg865._index1 = {:i.cinv,:i.lcno}
	selectdo	
	endselect	
}

|****************************Create HTML Invoice********************************
function create.html.invoice.header()
{
	string		r.siqr.txt(1000)mb,sbuf(959,40)			|Sanjeev - 22/09/2020
	domain tclang                    system.language
	string	qrcode.url(500)						|RAvi.a.s.18112020
	domain	tcmcs.str50		pass.string, handle.string
	
	docn.orno = lval(tdisg831.invn(4;8))
	ityp = tdisg831.invn(1;3)
	docn.orno.str = str$(docn.orno)
	
	select	ciisg800.comp
	from	ciisg800
	where	ciisg800.tran = :ityp
	and	ciisg800.docn = :docn.orno.str
	as set with 1 rows
	selectdo
	endselect
	
	pass.string = trim$(str$(ciisg800.comp)) & "_" &trim$(ityp) & "_" & trim$(Str$(docn.orno.str))
	handle.string =  "EINV_QRPNG_200"				|RAvi.a.e.18112020
	
	qrcode.url = ""
	r.siqr.txt = ""
	system.language = language$
| 	str.idoc = str$(cisli205.idoc)
	value_declare = ""
	select	ciisg801.qrst,ciisg801.irnn
	from	ciisg801
	where	ciisg801.ninv = {:tdisg831.invn}
	as set with 1 rows
	selectdo
	selectempty
		ciisg801.qrst = 0
		ciisg801.irnn = ""
	endselect	
	select    tttxt010.text
	from      tttxt010
	where   tttxt010._index1 = {:ciisg801.qrst,:system.language }
	selectdo
		if not isspace(trim$(tttxt010.text)) then
			if not isspace(r.siqr.txt) then
| 				r.siqr.txt = trim$(r.siqr.txt) & trim$(tttxt010.text)
				r.siqr.txt = r.siqr.txt & tttxt010.text
			else
| 				r.siqr.txt = trim$(tttxt010.text)
				r.siqr.txt = tttxt010.text
			endif
		endif     
	endselect
	r.siqr.txt = trim$(r.siqr.txt)
									|Sanjeev - 22/09/2020
	
	select	tcisg132.drid
	from	tcisg132
	where	tcisg132.hndl = :handle.string
	and	tcisg132.indx = :pass.string
	as set with 1 rows
	selectdo
	selectempty
		tcisg132.drid = ""
	endselect
	
	qrcode.url = "http://192.9.200.146/Attachment/ViewFile.aspx?AthHandle=" & trim$(handle.string) &
				"&Index=" & trim$(pass.string) & "&AttachedBy=" & trim$(logname$) & "&ed=n&t_drid=" & trim$(tcisg132.drid)

	temp.file	=	bse.tmp.dir$()
	
	file.name	=	strip$(shiftl$(temp.file)) & "//" & "TAX_INVOICE" & ".htm"
	local.file.name	=	"c:\temp\" & "TAX_INVOICE"&".htm"
	fp	=	seq.open(file.name, "w+")
	
	if	fp	<	0	then
		message("Error in Opening the File.")
		end()
	endif
	
	seq.puts("<html xmlns="&chr$(34)&"http://www.w3.org/1999/xhtml"&chr$(34)&">",fp)
	seq.puts("<head>",fp)
	seq.puts("<script src="&chr$(34)&"js/connectcode-javascript-code39.js"&chr$(34)&">",fp)
	seq.puts("</script>",fp)
	seq.puts("<script type="&chr$(34)&"text/javascript"&chr$(34)&" > function generateBarCode() { var nric = $('#text').val(); var url = 'https://api.qrserver.com/v1/create-qr-code/?data=' + nric + '&amp;size=50x50'; $('#barcode').attr('src', url); }",fp)
	seq.puts("</script>",fp)
	seq.puts("<style type="&chr$(34)&"text/css"&chr$(34)&">#barcode {font-weight: normal; font-style: normal; line-height:normal; sans-serif; font-size: 1pt}</style>",fp)
	seq.puts("</head>",fp)
	seq.puts("<html>",fp)
	seq.puts("<head>",fp)
	seq.puts("<style>",fp)
	seq.puts("body",fp)
	seq.puts("{",fp)
	seq.puts("font-family: Arial, Helvetica, sans-serif;",fp)
	seq.puts("font-size: 100px;",fp)
	seq.puts("font-style: normal;",fp)
        seq.puts("}",fp)
	
| 	seq.puts("table, th, td {",fp)
| 		seq.puts("border: 1px solid black;",fp)
| 		seq.puts("width: 100%;",fp)
| 		seq.puts("border-collapse: collapse;",fp)
| 	seq.puts("}",fp)
	seq.puts("table{",fp)
		seq.puts("border: 1px solid black;",fp)
		seq.puts("width: 100%;",fp)
		seq.puts("border-collapse: collapse;",fp)
| 		seq.puts("height: 1200px;",fp)
	seq.puts("}",fp)
	seq.puts("td, th{",fp)
		seq.puts("border: 1px solid black;",fp)
| 		seq.puts("LINE-HEIGHT:20px;",fp)
| 		seq.puts("width: 100%;",fp)
		seq.puts("border-collapse: collapse;",fp)
	seq.puts("}",fp)
	
	seq.puts("th{",fp)
	seq.puts("text-align: center; ",fp)
	seq.puts("}",fp)
	seq.puts("h2 {",fp)
	seq.puts("text-align: right;",fp)
	seq.puts("font-size: 15px;",fp)
	seq.puts("margin-right: 43px;",fp)
	seq.puts("}",fp)
	seq.puts("img {",fp)
	seq.puts("float: right;",fp)
	seq.puts("width: 90px;",fp)
	seq.puts("margin-right: 34px;",fp)
	seq.puts("margin-bottom: 5px;",fp)
	seq.puts("}",fp)
	seq.puts(".p1{text-align: right;padding-left: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}",fp)
	seq.puts(".p2{text-align: center;padding-left: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}",fp)
	seq.puts(".p3{text-align: left;padding-left: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}",fp)
	seq.puts(".ft1{font: bold 12px 'Arial'}",fp)
	seq.puts(".ft2{font: bold 11px 'Arial'}",fp)
	seq.puts(".bl{border-left: #000000}",fp)
	seq.puts(".br{border-right: #000000}",fp)
	seq.puts(".bt{border-top: #000000}",fp)
	seq.puts(".bb{border-bottom: #000000}",fp)
	seq.puts(".tal{text-align: left}",fp)
	seq.puts(".tar{text-align: right}",fp)
	seq.puts(".tac{text-align: center}",fp)
	seq.puts(".fta{font: 12px 'Arial'}",fp)
	seq.puts(".pb { page-break-before: always}",fp)						|RAvi.a.20102020
	
	seq.puts("</style>",fp)
	seq.puts("</head>",fp)
	
	seq.puts(" <body bgcolor="&chr$(34)&"#e4e4e4"&chr$(34)&" topmargin="&chr$(34)&"0"&chr$(34)&" leftmargin="&chr$(34)
		&"0"&chr$(34)&" marginheight="&chr$(34)&"0"&chr$(34)&" marginwidth="&chr$(34)&"0"&chr$(34)&" style="&chr$(34)
		&"-webkit-font-smoothing: antialiased; width: 100% !important; background: #e4e4e4; -webkit-text-size-adjust: none;"&chr$(34)
		&">",fp)

	seq.puts("<table  colspan="&chr$(34)&"14"&chr$(34)&" align="&chr$(34)&"center"&chr$(34)&" style="&chr$(34)&"width: 960px; height: auto; background: #fff; "&chr$(34)&">",fp)

	seq.puts("<tr>",fp)
        seq.puts("<td>",fp)
	seq.puts("<div class="&chr$(34)&"header_sub"&chr$(34)&" >",fp)
	
	seq.puts("<table>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<th colspan=18 class="&chr$(34)&"bl bt  br fta tac"&chr$(34)&"><strong>EXPORT INVOICE</strong><br>",fp)
		seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta tar"&chr$(34)&"> Page : 1",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)					|RAvi.a.s.30092020
		seq.puts("<td colspan=16  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta bt bl br fta"&chr$(34)&"><strong>IRN No. : </strong>" & trim$(ciisg801.irnn)&" </td>",fp)
		seq.puts("</td >",fp)
		
| 		seq.puts("<td colspan=3 class="&chr$(34)&"tar bt bb bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	
| 			&"https://api.qrserver.com/v1/create-qr-code/?data="&r.siqr.txt&"&amp;size=100x100"&chr$(34)&
| 			" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
| 			"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)
			seq.puts("<td colspan=3 class="&chr$(34)&"tar bt bb bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	|Sanjeev - 22/09/2020
			&qrcode.url & "&amp;size=100x100"&chr$(34)&
			" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
			"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)
	seq.puts("</tr>",fp)					|RAvi.a.e.30092020
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&"><strong>Exporter :</strong> <br>"
		& exp1,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar fta"&chr$(34)&"><strong>CIN:&nbsp;<br> IEC No.:&nbsp;</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tal fta"&chr$(34)&">"& cin.no.export&"<br>" 
		& iec.no.export,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Invoice No.:</strong> "&str$(tdisg831.invn)
		&" <br> <strong>Date:</strong>"&sprintf$("%D(%02d/%02m/%04Y)", tdisg831.invd),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>Exporter Ref No.:</strong> <br> "
		&tdisg831.xref ,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)& ">" & trim$(exp2)
		& "<br>"& trim$(exp3)& "<br>" & trim$(exp4),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar tar fta"&chr$(34)&
		"><strong>PAN&nbsp;No:&nbsp; <br> GSTIN&nbsp;No.:&nbsp; <br>GSTIN&nbsp;TYPE:</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&">"&pan.no.export &"<br>"
		&gstn.c.no
		&"<br> GSN",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=10 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&">"& str$(buyer_order) & sprintf$("%D(%02d/%02m/%04Y)", buyer_date),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.cust4&"</strong> <br> "&tpisg036.exp3,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.cust1&"</strong><br>"&con1&"<br>"
		&con2&"<br>"&con3&"<br>"&con4,fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=2 class="&chr$(34)&"fta"&chr$(34)&">"&
| 			"<img src="&chr$(34)&"https://a.uguu.se/QBCIjyFlWl73_temp.jpg"&chr$(34)&" width=100px"&chr$(34)&" align="&chr$(34)&"right"&chr$(34)&
| 			">",fp)
| 		seq.puts("<td colspan=2 class="&chr$(34)&"tal bt bb bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	|Sanjeev - 22/09/2020	|RAvi.com
| 			&"https://api.qrserver.com/v1/create-qr-code/?data="&r.siqr.txt&"&amp;size=100x100"&chr$(34)&
| 			" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
| 			"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)					||Sanjeev - 22/09/2020

		seq.puts("</td>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.cust2&"</strong><br>"&buyer1&"<br>"
		& buyer2&"<br>"&buyer3&"<br>"&buyer4,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
| 	seq.puts("<tr>",fp)								|RAvi.com.s.30092020
| 		seq.puts("<td colspan=20  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>IRN No. : </strong>" & trim$(ciisg801.irnn)&" </td>",fp)
| 		seq.puts("</td >",fp)
| 	seq.puts("</tr>",fp)								|RAvi.com.e.30092020
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.cust5&"<strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.cust6&"<strong><br>"&tdisg831.prec,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Country of Origin</strong><br>"&desc3,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Country of Final Destination</strong><br>"
		&desc4,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"fta"&chr$(34)&"><strong>"&tdisg861.com17&"</strong><br>"&tdisg831.ptld,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=10 rowspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"fta"&chr$(34)&"><strong>Term of Delivery and Payment</strong><br>"
		&term_delivery&"<br>"&mode&"<br>"&value_declare&"<br>"&text1&"<br>"&text2,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.com18&"</strong><br>"&tdisg831.ptds,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.cust7&"</strong><br>"&tdisg831.ctyd,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"br fta"&chr$(34)&"><strong>Bill of Lading No.</strong> "&tdisg839.biln&
		"<br> <strong>Vassel:</strong> "&tdisg839.vfln,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl fta"&chr$(34)&"><strong>Dated:</strong>"&sprintf$("%D(%02d/%02m/%04Y)", tdisg839.pddt)&"<br><strong>Voyage No.</strong>"
		&tdisg839.voyg,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl  fta"&chr$(34)&"><strong>Marks&nbsp;&&nbsp;Nos.</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl  tac fta"&chr$(34)&"><strong>No.&nbsp;of&nbsp;Kind of&nbsp;Plug</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl  tac fta"&chr$(34)&"><strong>Description of Goods</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1  rowspan=3 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>HSN/SAC</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1  rowspan=3 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>DBK&nbsp;Sr. No.</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=3 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>UQC</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=3 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Quantity</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac fta"&chr$(34)&"><strong>Value In INR</strong>",fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta tac"&chr$(34)&"><strong>Value In USD without GST</strong>",fp)		|RAvi.cng12102020
		seq.puts("<td colspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta tac"&chr$(34)&"><strong>Value In " & tppdm740.ccur &  " without GST</strong>",fp)		|RAvi.cng17122020
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&">"&chr$(34)& tpisg036.exp1 &chr$(34)&
		"<br> "&chr$(34)&tpisg036.exp2,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&">"&tdisg825.des1&"<br> "&tdisg825.des2,fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=1 rowspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&">",fp)
| 		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=1 rowspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&">",fp)
| 		seq.puts("</td >",fp)
		seq.puts("<td colspan=1  rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Rate per Unit</strong>",fp)			|RAvi.cng12102020
		seq.puts("</td >",fp)		
		seq.puts("<td colspan=1  rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Taxable Value</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac fta"&chr$(34)&"><strong>IGST</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1  rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Total Value</strong>",fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=1 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Rate</strong> <br>"&Lumpsum,fp)
| 		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=1 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Total Value CIF</strong>",fp)
		seq.puts("<td colspan=1 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Total Value " 
			& trim$(delivery_term) & "</strong>",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		
| 		seq.puts("<td colspan=1 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Rate</strong><br>"& lumpsum,fp)
		seq.puts("<td colspan=1 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Rate</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Amt</strong>",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&"> <strong>COUNTRY OF ORIGIN</strong><br> "& desc3 & "<br>"&tdisg831.pcar,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl  fta"&chr$(34)&">"&tdisg825.des3&"<br> "&tdisg825.des4&
		"<br> "&tdisg825.des5 &"<br> "&tdisg825.des6&"-----------------------------------------------------------<br><strong>(PARTIAL SHIPMENT)</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}

function create.custom.inv.nos.line.total()
{
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&
			"><br><br><strong>PACKAGES&nbsp;NOS</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bb bt br bl fta"&chr$(34)&
			">================================<br>TOTAL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
			& sprintf$("%-*.*f",10,2,total.pack)& "Pkgs<br>================================",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)	
}

function create.custom.inv.nos.line()
{
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bb bt br bl fta"&chr$(34)&
			">"&tdisg007.type&"&nbsp;&nbsp;"&sprintf$("%-*.*f",10,2,tot.nopk)&"Nos",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)	
}

function create.invoice.lines()
{
	domain	tcamnt	price.to
	price.to = 0 
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=1  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&"><br><br><br><br><br><br><br><br><br><br><br><br><br>"&tdisg832.pkgd,fp)
		seq.puts("</td>",fp)
		
		if ((not isspace(dbk_description1)) and (not isspace(hsn.description1))) then
			seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&
				"><br><strong>HSN CODE DESCRIPTION</strong><br>"
				&hsn.description1&"<br>"&hsn.description2&"<br>"&hsn.description3&"<br>"&hsn.description4&"<br><strong>DBK CODE DESCRIPTION</strong><br>"&dbk_description1&
				"<br>"&dbk_description2&"<br>"&dbk_description3&"<br>"&dbk_description4&
				"<br>=================================================<br>"&description1&"<br>",fp)
		else
			if not isspace(hsn.description1) then
				seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&
				"><br><strong>HSN CODE DESCRIPTION</strong><br>"
				&hsn.description1&"<br>"&hsn.description2&"<br>"&hsn.description3&"<br>"&hsn.description4&
				"<br>=================================================<br>"&description1&"<br>",fp)
			else
				if not isspace(dbk_description1) then
					seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&
						"><br><strong>DBK CODE DESCRIPTION</strong><br>"&dbk_description1&
						"<br>"&dbk_description2&"<br>"&dbk_description3&"<br>"&dbk_description4&
						"<br>=================================================<br>"&description1&"<br>",fp)	
				else
					seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&
						"><br><br>"&dbk_description1&"<br>"&dbk_description2&"<br>"&dbk_description3&"<br>"&dbk_description4&
						"<br>=================================================<br>"&description1&"<br>",fp)		
				endif
			endif	
		endif
		
		if tdisg832.pqty <> 0 then
			price.to = inr.amnt/tdisg832.pqty
		else
			price.to = inr.amnt/1
		endif
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">"&tdisg832.code,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">"& tdisg832.tfcd,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">"&tdisg832.pcun,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tdisg832.pqty),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,price.to),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,inr.amnt),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">"& sprintf$("%-*.*f",10,2,igst.rate),fp)		|RAvi.a.07102020
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">"& sprintf$("%-*.*f",10,2,tax.amnt),fp)		|RAvi.a.07102020
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,total.amnt.r),fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
| 		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tdisg832.bivl),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}


function create.html.we.intend()
{	
	if p = 10 then
	
	if invoice.line.count = 3 then
		seq.puts("</table>",fp)
		seq.puts("</div>",fp)
		seq.puts("</td>",fp)
		seq.puts("</table>",fp)
| 		seq.puts("</body>",fp)
| 		seq.puts("</html>",fp)
		seq.puts("<p class = " &chr$(34)& "pb" &chr$(34)& "></p>",fp)
		
		seq.puts("<table  colspan="&chr$(34)&"20"&chr$(34)&" align="&chr$(34)&"center"&chr$(34)&" style="&chr$(34)&"width: 1050px; height: auto; background: #fff; "&chr$(34)&">",fp)


		seq.puts("<tr>",fp)
		seq.puts("<td>",fp)
		seq.puts("<div class="&chr$(34)&"header_sub"&chr$(34)&" >",fp)
		
		seq.puts("<table>",fp)
		seq.puts("<tr>",fp)
			seq.puts("<th colspan=18 class="&chr$(34)&"bl bt  br fta tac"&chr$(34)&"><strong>EXPORT INVOICE</strong><br>",fp)
			seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta tar"&chr$(34)&"> Page : 1",fp)
			seq.puts("</td >",fp)
		seq.puts("</tr>",fp)
| 		seq.puts("<tr>",fp)					|RAvi.a.s.30092020
| 			seq.puts("<td colspan=18  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta bt bl br fta"&chr$(34)&"><strong>IRN No. : </strong>" & trim$(ciisg801.irnn)&" </td>",fp)
| 			seq.puts("</td >",fp)
| 			
| 			seq.puts("<td colspan=2 class="&chr$(34)&"tar bt bb bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	
| 				&"https://api.qrserver.com/v1/create-qr-code/?data="&r.siqr.txt&"&amp;size=100x100"&chr$(34)&
| 				" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
| 				"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)			

| 		seq.puts("</tr>",fp)					|RAvi.a.e.30092020
		seq.puts("<tr>",fp)
			seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&"><strong>Exporter :</strong> <br>"
			& exp1,fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar fta"&chr$(34)&"><strong>CIN:&nbsp;<br> IEC No.:&nbsp;</strong>",fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tal fta"&chr$(34)&">"& cin.no.export&"<br>" 
			& iec.no.export,fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=3  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Invoice No.:</strong> "&str$(tdisg831.invn)
			&" <br> <strong>Date:</strong>"&sprintf$("%D(%02d/%02m/%04Y)", tdisg831.invd),fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>Exporter Ref No.:</strong> <br> "
			&tdisg831.xref ,fp)
			seq.puts("</td >",fp)
		seq.puts("</tr>",fp)
		
		seq.puts("<tr>",fp)
			seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)& ">" & trim$(exp2)
			& "<br>"& trim$(exp3)& "<br>" & trim$(exp4),fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar tar fta"&chr$(34)&
			"><strong>PAN&nbsp;No:&nbsp; <br> GSTIN&nbsp;No.:&nbsp; <br>GSTIN&nbsp;TYPE:</strong>",fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&">"&pan.no.export &"<br>"
			&gstn.c.no
			&"<br> GSN",fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=10 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&">"& str$(buyer_order) & sprintf$("%D(%02d/%02m/%04Y)", buyer_date),fp)
			seq.puts("</td >",fp)
		seq.puts("</tr>",fp)
	endif
	
	seq.puts("<tr>",fp)
| 		seq.puts("<td colspan=10 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"  bt br bl fta"&chr$(34)&
| 			"><br><br>"&dbk_des4&"<br>"&dbk_des6&"<br>"&dbk_des7&"<br>"&dbk_des3&"<br>"&dbk_des5&"<br>"&dbk_des1&"<br>"&dbk_des2&"<br>"&meis.des1&"<br>"&meis.des2&"<br>"&term.line&"<br>"
| 			&"<br>"&dbk_description2&"<br>"&dbk_description3&"<br>"&dbk_description4,fp)
| 		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=10 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"  bt br bl fta"&chr$(34)&
| 			"><br><br>"&dbk_des4&"<br>"&dbk_des6&"<br>"&dbk_des7&"<br>"&dbk_des8&"<br>"&dbk_des9&"<br>"&dbk_des3&"<br>"&dbk_des5&"<br>"
| 			&meis.des1&"<br>"&meis.des2&"<br>"&term.line&"<br>"&lut.line,fp)
		seq.puts("<td colspan=10 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"  bt br bl fta"&chr$(34)&
			"><br><br>"&dbk_des4&"<br><br>"&dbk_des6 & dbk_des7 & dbk_des8 & dbk_des9 &"<br><br>" &dbk_des3 &dbk_des5&"<br><br>"
			&meis.des1 &meis.des2 &"<br><br>" &meis.des3 &"<br><br>"&term.line &"&nbsp;&nbsp;" & lut.line,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"middle"&chr$(34)&" class="&chr$(34)&"bt bb  tac fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	endif

	if invoice.line.count = 2 then
		seq.puts("</table>",fp)
		seq.puts("</div>",fp)
		seq.puts("</td>",fp)
		seq.puts("</table>",fp)
| 		seq.puts("</body>",fp)
| 		seq.puts("</html>",fp)
		seq.puts("<p class = " &chr$(34)& "pb" &chr$(34)& "></p>",fp)
		
		seq.puts("<table  colspan="&chr$(34)&"14"&chr$(34)&" align="&chr$(34)&"center"&chr$(34)&" style="&chr$(34)&"width: 1050px; height: auto; background: #fff; "&chr$(34)&">",fp)


		seq.puts("<tr>",fp)
		seq.puts("<td>",fp)
		seq.puts("<div class="&chr$(34)&"header_sub"&chr$(34)&" >",fp)
		
		seq.puts("<table>",fp)
		seq.puts("<tr>",fp)
			seq.puts("<th colspan=18 class="&chr$(34)&"bl bt  br fta tac"&chr$(34)&"><strong>EXPORT INVOICE</strong><br>",fp)
			seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta tar"&chr$(34)&"> Page : 1",fp)
			seq.puts("</td >",fp)
		seq.puts("</tr>",fp)
| 		seq.puts("<tr>",fp)					|RAvi.a.s.30092020
| 			seq.puts("<td colspan=18  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta bt bl br fta"&chr$(34)&"><strong>IRN No. : </strong>" & trim$(ciisg801.irnn)&" </td>",fp)
| 			seq.puts("</td >",fp)
| 			
| 			seq.puts("<td colspan=2 class="&chr$(34)&"tar bt bb bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	
| 				&"https://api.qrserver.com/v1/create-qr-code/?data="&r.siqr.txt&"&amp;size=100x100"&chr$(34)&
| 				" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
| 				"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)			

| 		seq.puts("</tr>",fp)					|RAvi.a.e.30092020
		seq.puts("<tr>",fp)
			seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&"><strong>Exporter :</strong> <br>"
			& exp1,fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar fta"&chr$(34)&"><strong>CIN:&nbsp;<br> IEC No.:&nbsp;</strong>",fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tal fta"&chr$(34)&">"& cin.no.export&"<br>" 
			& iec.no.export,fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=3  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Invoice No.:</strong> "&str$(tdisg831.invn)
			&" <br> <strong>Date:</strong>"&sprintf$("%D(%02d/%02m/%04Y)", tdisg831.invd),fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>Exporter Ref No.:</strong> <br> "
			&tdisg831.xref ,fp)
			seq.puts("</td >",fp)
		seq.puts("</tr>",fp)
		
		seq.puts("<tr>",fp)
			seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)& ">" & trim$(exp2)
			& "<br>"& trim$(exp3)& "<br>" & trim$(exp4),fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar tar fta"&chr$(34)&
			"><strong>PAN&nbsp;No:&nbsp; <br> GSTIN&nbsp;No.:&nbsp; <br>GSTIN&nbsp;TYPE:</strong>",fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&">"&pan.no.export &"<br>"
			&gstn.c.no
			&"<br> GSN",fp)
			seq.puts("</td >",fp)
			seq.puts("<td colspan=10 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&">"& str$(buyer_order) & sprintf$("%D(%02d/%02m/%04Y)", buyer_date),fp)
			seq.puts("</td >",fp)
		seq.puts("</tr>",fp)
	endif
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb  br bl tar fta"&chr$(34)&"><strong>TOTAL</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=9 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb  br bl tar fta"&chr$(34)&"><strong>"&tdisg861.head&"</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb  br bl tar fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tot.inr.amnt),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb  br bl tar fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tot.tax.amnt),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tot.inr.amnt.with.tax),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tot_amount),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}
function create.html.amount.total()
{
	long i
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl tar fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=9 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb bl br  tar fta"&chr$(34)&">"&tdisg860.desc,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl tar fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,lc.amnt.inr),fp)
		seq.puts("</td >",fp)
		for i = 1 to 3 
			seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb tar fta"&chr$(34)&">",fp)
			seq.puts("</td >",fp)
		endfor
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,lc.amnt),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}

function create.final.html.invoice()
{
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl tar fta"&chr$(34)&"><strong>NET PAYBLE</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=9 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tar bb bt br bl fta"&chr$(34)&">"&net.payable.line,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl tar fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta tar "&chr$(34)&">"&sprintf$("%-*.*f",10,2,final.total.inr),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=1 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,final.total),fp)
		seq.puts("</td >",fp)

	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br tar bl fta"&chr$(34)&">"&tppdm740.ccur&"<br>INR",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=14 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl fta"&chr$(34)&">"&amt_str&"<br>"&amt_str.inr,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=14 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl fta"&chr$(34)&
			"><strong>GROSS AMOUNT OF INVOICE(IN WORDS)<br>"&tppdm740.ccur&"&nbsp;"&"&nbsp;"&cash.str&"<br>INR"&"&nbsp;&nbsp;"&cash.str.inr&"<br>"
			&rate.type.line&"<br>WEHTHER THE TAX IS PAYBLE ON REVERSE CHARGE BASIS:NO<br>DECLARATION:</strong>"
			&" WE DECLARE THAT INVOICE SHOWS THE ACTUAL PRICE OF THE GOODS AND DESCRIBED AND THAT ALL PARTICULARS ARE TRUE AND CORRECT<br><strong>SUPPLIER's TAX INVOICE DETAILS AS PER ANNEXURE ATTACHED.</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>FOR ISGEC HEAVY ENGINEERING LTD.<br><br><br><br><br>Authorised Signatory</strong>",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("</table>",fp)
	seq.puts("</div>",fp)
	seq.puts("</td>",fp)
	seq.puts("</table>",fp)
	
	seq.puts("<p class = " &chr$(34)& "pb" &chr$(34)& "></p>",fp)
| 	seq.puts("</body>",fp)
| 	seq.puts("</html>",fp)
	
| 	seq.close(fp)
| 	ret2	=	server2client(file.name,local.file.name,1)
| 	ret2	=	app_start(local.file.name,"c:","","","")
}

|***************************Commercial Invoice**********************************
function create.html.com.invoice.header()
{
	string		r.siqr.txt(1000)mb,sbuf(959,40)			|Sanjeev - 22/09/2020
	domain tclang                    system.language
	string	qrcode.url(500)							|RAvi.a.s.18112020
	domain	tcmcs.str50		pass.string, handle.string
	
| 	idoc = lval(tdisg831.cinv(4;8))
	ityp = tdisg831.cinv(1;3)
	docn.orno.str = tdisg831.cinv
	
	select	ciisg800.comp
	from	ciisg800
	where	ciisg800.tran = :ityp
	and	ciisg800.docn = :docn.orno.str
	as set with 1 rows
	selectdo
	endselect
	
	pass.string = trim$(str$(ciisg800.comp)) & "_" &trim$(ityp) & "_" & trim$(Str$(docn.orno.str))
	handle.string =  "EINV_QRPNG_200"

	qrcode.url = ""								|RAvi.a.e.18112020
	r.siqr.txt = ""
	system.language = language$
| 	str.idoc = str$(cisli205.idoc)
	select	ciisg801.qrst,ciisg801.irnn
	from	ciisg801
	where	ciisg801.ninv = {:tdisg831.cinv}
	as set with 1 rows
	selectdo
	selectempty
		ciisg801.qrst = 0
		ciisg801.irnn = ""
	endselect	
	select    tttxt010.text
	from      tttxt010
	where   tttxt010._index1 = {:ciisg801.qrst,:system.language }
	selectdo
		if not isspace(trim$(tttxt010.text)) then
			if not isspace(r.siqr.txt) then
| 				r.siqr.txt = trim$(r.siqr.txt) & trim$(tttxt010.text)
				r.siqr.txt = r.siqr.txt & tttxt010.text
			else
| 				r.siqr.txt = trim$(tttxt010.text)
				r.siqr.txt = tttxt010.text
			endif
		endif     
	endselect
	r.siqr.txt = trim$(r.siqr.txt)
									|Sanjeev - 22/09/2020
									
	select	tcisg132.drid
	from	tcisg132
	where	tcisg132.hndl = :handle.string
	and	tcisg132.indx = :pass.string
	as set with 1 rows
	selectdo
	selectempty
		tcisg132.drid = ""
	endselect
	
	qrcode.url = "http://192.9.200.146/Attachment/ViewFile.aspx?AthHandle=" & trim$(handle.string) &
				"&Index=" & trim$(pass.string) & "&AttachedBy=" & trim$(logname$) & "&ed=n&t_drid=" & trim$(tcisg132.drid)

	temp.file	=	bse.tmp.dir$()
	
	file.name	=	strip$(shiftl$(temp.file)) & "//" & "COMMERCIAL_INVOICE" & ".htm"
	local.file.name	=	"c:\temp\" & "COMMERCIAL_INVOICE"&".htm"
	fp	=	seq.open(file.name, "w+")
	
	if	fp	<	0	then
		message("Error in Opening the File.")
		end()
	endif
	
	seq.puts("<html xmlns="&chr$(34)&"http://www.w3.org/1999/xhtml"&chr$(34)&">",fp)
	seq.puts("<head>",fp)
	seq.puts("<script src="&chr$(34)&"js/connectcode-javascript-code39.js"&chr$(34)&">",fp)
	seq.puts("</script>",fp)
	seq.puts("<script type="&chr$(34)&"text/javascript"&chr$(34)&" > function generateBarCode() { var nric = $('#text').val(); var url = 'https://api.qrserver.com/v1/create-qr-code/?data=' + nric + '&amp;size=50x50'; $('#barcode').attr('src', url); }",fp)
	seq.puts("</script>",fp)
	seq.puts("<style type="&chr$(34)&"text/css"&chr$(34)&">#barcode {font-weight: normal; font-style: normal; line-height:normal; sans-serif; font-size: 1pt}</style>",fp)
	seq.puts("</head>",fp)
	seq.puts("<html>",fp)
	seq.puts("<head>",fp)
	seq.puts("<style>",fp)
	seq.puts("body",fp)
	seq.puts("{",fp)
	seq.puts("font-family: Arial, Helvetica, sans-serif;",fp)
	seq.puts("font-size: 100px;",fp)
	seq.puts("font-style: normal;",fp)
        seq.puts("}",fp)
	
	seq.puts("table, th, td {",fp)
		seq.puts("border: 1px solid black;",fp)
		seq.puts("width: 100%;",fp)
		seq.puts("border-collapse: collapse;",fp)
	seq.puts("}",fp)
	seq.puts("th{",fp)
	seq.puts("text-align: center; ",fp)
	seq.puts("}",fp)
	seq.puts("h2 {",fp)
	seq.puts("text-align: right;",fp)
	seq.puts("font-size: 15px;",fp)
	seq.puts("margin-right: 43px;",fp)
	seq.puts("}",fp)
	seq.puts("img {",fp)
	seq.puts("float: right;",fp)
	seq.puts("width: 90px;",fp)
	seq.puts("margin-right: 34px;",fp)
	seq.puts("margin-bottom: 5px;",fp)
	seq.puts("}",fp)
	seq.puts(".p1{text-align: right;padding-left: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}",fp)
	seq.puts(".p2{text-align: center;padding-left: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}",fp)
	seq.puts(".p3{text-align: left;padding-left: 12px;margin-top: 0px;margin-bottom: 0px;white-space: nowrap;}",fp)
	seq.puts(".ft1{font: bold 12px 'Arial'}",fp)
	seq.puts(".ft2{font: bold 11px 'Arial'}",fp)
	seq.puts(".bl{border-left: #000000}",fp)
	seq.puts(".br{border-right: #000000}",fp)
	seq.puts(".bt{border-top: #000000}",fp)
	seq.puts(".bb{border-bottom: #000000}",fp)
	seq.puts(".tal{text-align: left}",fp)
	seq.puts(".tar{text-align: right}",fp)
	seq.puts(".tac{text-align: center}",fp)
	seq.puts(".fta{font: 12px 'Arial'}",fp)
	
	seq.puts("</style>",fp)
	seq.puts("</head>",fp)
	
	seq.puts(" <body bgcolor="&chr$(34)&"#e4e4e4"&chr$(34)&" topmargin="&chr$(34)&"0"&chr$(34)&" leftmargin="&chr$(34)
		&"0"&chr$(34)&" marginheight="&chr$(34)&"0"&chr$(34)&" marginwidth="&chr$(34)&"0"&chr$(34)&" style="&chr$(34)
		&"-webkit-font-smoothing: antialiased; width: 100% !important; background: #e4e4e4; -webkit-text-size-adjust: none;"&chr$(34)
		&">",fp)

	seq.puts("<table  colspan="&chr$(34)&"14"&chr$(34)&" align="&chr$(34)&"center"&chr$(34)&" style="&chr$(34)&"width: 740px; height: auto; background: #fff; "&chr$(34)&">",fp)


	seq.puts("<tr>",fp)
        seq.puts("<td>",fp)
	seq.puts("<div class="&chr$(34)&"header_sub"&chr$(34)&" >",fp)
	
	seq.puts("<table>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<th colspan=15 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"><strong>COMMERCIAL INVOICE</strong><br>",fp)
		seq.puts("<td colspan=5 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"> Page : 1",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta bt bl br fta"&chr$(34)&"><strong>IRN&nbsp;No.</strong>" & trim$(ciisg801.irnn)&" </td>",fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=10 class="&chr$(34)&"tar bt bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	|RAvi.com.s
| 		&"https://api.qrserver.com/v1/create-qr-code/?data="&r.siqr.txt&"&amp;size=100x100"&chr$(34)&
| 		" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
| 		"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)					|RAvi.com.e
		
		seq.puts("<td colspan=10 class="&chr$(34)&"tar bt bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	|Sanjeev - 22/09/2020
			&qrcode.url & "&amp;size=100x100"&chr$(34)&
			" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
			"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)
		
	seq.puts("</tr>",fp)
			
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&"><strong>"&tdisg861.com11&"</strong><br>"&exp1&
		"<br>"&exp2&" <br>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=4 nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br tar fta"&chr$(34)&"><strong>"&tdisg861.com1&"<br>"&tdisg861.com2&"</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br tar fta"&chr$(34)&">"&tdisg831.cinv&"<br>"&sprintf$("%D(%02d/%02m/%04Y)", tdisg831.cind),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=4 nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>Exporter&nbsp;Ref&nbsp;No.:</strong><br> "
		&tdisg831.xref ,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl bt bb br fta"&chr$(34)&"><strong>"&"<br>"&exp3&"<br>"&exp4,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=10  rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>"&tdisg861.com3&"</strong><br>"
			& custom.invoice(1,1)&"<br>"&custom.invoice(1,2)&"<br>"&custom.invoice(1,3)&"<br>"&custom.invoice(1,4)&"<br>"&custom.invoice(1,5)&
			"<br>"&custom.invoice(1,6)&"<br>"&custom.invoice(1,7),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.com12&"</strong><br>"&con1&"<br>"
		&con2&"<br>"&con3&"<br>"&con4,fp)
		seq.puts("</td >",fp)
| 		seq.puts("<td colspan=2 class="&chr$(34)&"fta"&chr$(34)&">"&
| 			"<img src="&chr$(34)&"https://a.uguu.se/QBCIjyFlWl73_temp.jpg"&chr$(34)&" width=100px"&chr$(34)&" align="&chr$(34)&"right"&chr$(34)&
| 			">",fp)
| 		seq.puts("<td colspan=2 class="&chr$(34)&"tal bt bb bl br fta"&chr$(34)&" ><img id='barcode' src="&chr$(34)	|Sanjeev - 22/09/2020	|RAvi.com.s
| 			&"https://api.qrserver.com/v1/create-qr-code/?data="&r.siqr.txt&"&amp;size=100x100"&chr$(34)&
| 			" alt="&chr$(34)&""&chr$(34)&" title="&chr$(34)&""&chr$(34)&" width="&chr$(34)&
| 			"100"&chr$(34)&" height="&chr$(34)&"100"&chr$(34)&" /></td>",fp)					||Sanjeev - 22/09/2020	RAvi.com.e| 		seq.puts("</td>",fp)
	seq.puts("</tr>",fp)
	
| 	seq.puts("<tr>",fp)
| 		seq.puts("<td colspan=20  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)&"><strong>IRN&nbsp;No.</strong>" & trim$(ciisg801.irnn)&" </td>",fp)
| 		seq.puts("</td >",fp)
| 	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"br fta"&chr$(34)&"><strong>"&tdisg861.com7&"</strong><br>"&tdisg839.biln,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl fta"&chr$(34)&"><strong>Dated:</strong>"&sprintf$("%D(%02d/%02m/%04Y)", tdisg839.pddt),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=10 rowspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Buyer (If Other than Consignee)</strong><br>"
			&buyer1&"<br>"&buyer2&"<br>"&buyer3,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=5  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"br fta"&chr$(34)&"><strong>"&tdisg861.com8&"</strong><br>"&tdisg839.vfln,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5 nowrap  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bl fta"&chr$(34)&">Voy No."&tdisg839.voyg,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.com17&"</strong><br>"&tdisg839.plod,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5  nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Country of Origin of Goods</strong><br>"&desc3,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=5 nowrap valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Country of Final Destination</strong><br>"
		&desc4,fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.com18&"</strong><br>"&tdisg831.ptds,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=10 rowspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>"&tdisg861.com10&"</strong><br>"&term_delivery&"<br>"&mode&"<br>"&text1&"<br>"&text2,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("</tr>",fp)
		seq.puts("<td colspan=10  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" fta"&chr$(34)&"><strong>Place of Delivery</strong>&emsp;"&tdisg831.ctyd,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=4  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl  fta"&chr$(34)&"><strong>"&tdisg861.com15&"</strong><br><br>"
		&tpisg036.exp1&tpisg036.exp2&"COUNTRY OF ORIGIN<br>"&desc3,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=3  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl  tac fta"&chr$(34)&"><strong>No.&nbsp;of&nbsp;Kind of&nbsp;Plug</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl  tal fta"&chr$(34)&"><strong>Description of Goods</strong><br>"&goods1&"<br>"
		&goods2&"<br>"&goods3&"<br>"&goods4&"<br>"&goods5&"<br>"&goods6&"-------------------------------------------------------<br><strong>(PARTIAL SHIPMENT)</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bb fta"&chr$(34)&"><strong>Quantity</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bb fta"&chr$(34)&"><strong>Rate</strong><br>"&lumpsum,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bb fta"&chr$(34)&"><strong>Amount</strong><br>"&tcmcs002.dsca&
		"<br>"&delivery_term&"&nbsp;Value",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}

function create.com.inv.nos.line()
{
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=3   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bt bb br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bt bb br bl fta"&chr$(34)&">"& tdisg007.type,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bt bb br bl fta"&chr$(34)&">"& str$(tot.nopk)& "&nbsp;Nos",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}

function create.com.inv.nos.line.total()
{
	seq.puts("</tr>",fp)
		seq.puts("<td colspan=3   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bt bb br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=4   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bt bb br bl fta"&chr$(34)&">========================",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=3   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bt bb br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bt bb br bl fta"&chr$(34)&"><strong>Total</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal bt bb br bl fta"&chr$(34)&"><strong>"&sprintf$("%-*.*f",10,2,total.pack )&"&nbsp;Pkgs<strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=7 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tac bt bb  fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}
	

function create.com.invoice.lines()
{
	get.text = ""
	if tpisg031.txta > 0 then
		temp.text = creat.tmp.file$(bse.tmp.dir$())
		text.read( "tpisg031.txta", "2",
			       kw1, kw2, kw3, kw4, txtg, opwd, temp.text, 0)
		txt.pntr = seq.open(temp.text, "r")
		txt.pntr1 = seq.gets (get.text, 2048,txt.pntr )
	endif
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=5   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl fta"&chr$(34)&">"&tdisg832.pkgd&"<br>"&description3&"<br>"&get.text,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=9   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl fta"&chr$(34)&">"&str$(srno)&"&nbsp;"&tpisg031.dsca(1;50),fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2   valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tdisg832.pqty )&"&nbsp;"&tdisg832.pcun,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tdisg832.bivl ),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}

function create.com.invoice.total.lines()
{
	seq.puts("<tr>",fp)
		seq.puts("<tr>",fp)
		seq.puts("<td colspan=16 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb  br bl tar fta"&chr$(34)&">"&tdisg861.head,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb  br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb tar  fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,i.total.fob ),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}

function create.com.invoice.total.lines1()
{
	seq.puts("<tr>",fp)
		seq.puts("<tr>",fp)
		seq.puts("<td colspan=16 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl tar fta"&chr$(34)&">"&tdisg865.desc,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tdisg865.amnt ),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
}


function create.final.html.com.invoice()
{
	tdisg865.amnt = (round(tdisg865.amnt,2,1))	
	tfgld.dll9998.in.words(tdisg865.amnt,cash.str)
	
	cash.str = trim$(cash.str) & ")"
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=16 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl tar fta"&chr$(34)&">"&tdisg865.desc,fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tar fta"&chr$(34)&">"&sprintf$("%-*.*f",10,2,tdisg865.amnt),fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=18 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&" bb bt br bl tar fta"&chr$(34)&"><strong>("&tcmcs002.dsca&"&nbsp;"&cash.str&"</strong>",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=2 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"bb bt br bl fta"&chr$(34)&">",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=14 rowspan=1  valign="&chr$(34)&"bottom"&chr$(34)&" class="&chr$(34)&" bb bt br bl tal fta"&chr$(34)&
		"><strong>DECLARATION:</strong><br>WE DECLARE THIS INVOICE SHOWS THE ACTUAL PRICE OF THE GOODS DESCRIBED AND THAT ALL PARTICULARS ARE TRUE & CORRECT",fp)
		seq.puts("</td >",fp)
		seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"fta"&chr$(34)&">for&nbsp;&nbsp;"&exp1&"<br><br><br>"&tpisg036.head,fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("</table>",fp)
	seq.puts("</div>",fp)
	seq.puts("</td>",fp)
	seq.puts("</table>",fp)
	seq.puts("</body>",fp)
	seq.puts("</html>",fp)
	
	seq.close(fp)

	ret2	=	server2client(file.name,local.file.name,1)
	ret2	=	app_start(local.file.name,"c:","","","")
}
        
function get.tax.data()
{
	domain	tcamnt		line.tax.amount.array(1, 1)	based
	domain	tcamnt		line.base.amount.array(1, 1)	based
	domain	tccvat		line.tax.code.array(1, 1)	based
	domain	tctax.indt.l	o.line.indirect.tax.array(1, 1)	based
	domain	tctax.indt.l	i.duty.type.array(1, 1)		based
	domain	tcyesno		expensed.tax(1, 1)		based
	domain	tcmcs.s250m	o.comb.output.set(1)		based
	domain	tcpvat		o.tax.rates(1,1)		based
	domain	tcamnt		i.duties.array(1,1)		based
	domain tctax.seqn 	o.maximum.sequence.number
	domain tcamnt 		o.claimable.tax.amount
	domain tcamnt 		o.non.claimable.tax.amount
	domain tcamnt 		o.total.tax.amount
	domain tcamnt 		o.sales.tax
	domain tcmcs.s250m 	o.error.msg mb
	domain	tcamnt		tmp.rate
	
	domain	tctax.indt.l	o.indt.l
	
	cgst.amnt = 0.00
	sgst.amnt = 0.00
	igst.amnt = 0.00
	
	cgst.rate = 0.00
	sgst.rate = 0.00
	igst.rate = 0.00
	assv.val = inr.amnt
	tax.amnt = 0
	
	select	tdisg831.cprj,
		tdisg831.ofbp,
		tdisg831.ccty
	from	tdisg831
	where	tdisg831._index1 = {:tdisg832.edrn}
	as set with 1 rows
	selectdo
	endselect
	
| 	select	tppin020.ccty
| 	from	tppin020
| 	where	tppin020._index1 = {:tdisg831.cprj, :tdisg831.ofbp, :tpisg039.nins}
| 	selectdo
| 	selectempty
| 		tppin020.ccty = ""
| 	endselect
		
	select 	tppdm740.rtyp, tppdm740.ccur
	from	tppdm740
	where	tppdm740._index1 = {:tdisg831.cprj, :tdisg831.ofbp}
	as set with 1 rows
	selectdo
	selectempty
		tppdm740.rtyp = ""
		tppdm740.ccur = ""
	endselect
	
	tctax.dll9141.determine.aggregate.tax.amounts.per.line( 
					tdisg831.ccty,				| domain tcccty i.tax.country, 
| 					tdisg832.cvat,				| domain tccvat i.aggregate.tax.code, 
| 					tdisg831.cvat,				| domain tccvat i.aggregate.tax.code,  	|GH489CR000.o
					tdisg831.ccvt,				| domain tccvat i.aggregate.tax.code, 	|GH489CR000.n
					utc.num(),				| domain tcdate i.tax.date, 
					assv.val,				| domain tcamnt i.order.line.price, 
					assv.val,				| domain tcamnt i.customs.value, 
					assv.val,				| domain tcamnt i.market.retail.price, 
					0.00,					| domain tcamnt i.retail.sales.price, 
					0.00,					| domain tcamnt i.tariff.price, 
					tppdm740.ccur,				| domain tcccur i.price.currency, 
					utc.num(),				| domain tcdate i.currency.rate.date, 
					tppdm740.rtyp,				| domain tcrtyp i.currency.exchange.rate.type, 
					assv.val,				| domain tcpric i.asv.excise, 
					assv.val,				| domain tcpric i.asv.vat, 
					assv.val,				| domain tcpric i.asv.service.tax, 
					assv.val,				| domain tcpric i.asv.gst, |#ISGEC017006.n
					utc.num(),				| domain tcdate i.ship.or.receive.date, 
					tcyesno.no,				| domain tcyesno i.as.is.sales, 
					tcyesno.no,				| domain tcyesno i.yesno.flag, 
					i.duty.type.array,			| ref domain tctax.indt.l i.duty.type.array(,), 
					i.duties.array,				| ref domain tcamnt i.duties.array(,), 
					o.tax.rates,				| ref domain tcpvat o.tax.rates(,), 
					o.maximum.sequence.number,		| ref domain tctax.seqn o.maximum.sequence.number, 
					line.base.amount.array,			| ref domain tcamnt o.line.base.amount.array(,), 
					line.tax.amount.array,			| ref domain tcamnt o.line.tax.amount.array(,), 
					line.tax.code.array,			| ref domain tccvat o.line.tax.code.array(,) fixed, 
					o.line.indirect.tax.array,		| ref domain tctax.indt.l o.line.indirect.tax.array(,), 
					expensed.tax,				| ref domain tcyesno o.expensed.tax(,), 
					o.claimable.tax.amount,			| ref domain tcamnt o.claimable.tax.amount, 
					o.non.claimable.tax.amount,		| ref domain tcamnt o.non.claimable.tax.amount, 
					o.total.tax.amount,			| ref domain tcamnt o.total.tax.amount, 
					o.sales.tax,				| ref domain tcamnt o.sales.tax, 
					o.comb.output.set,			| ref domain tcmcs.s250m o.comb.output.set() fixed mb, 
					o.error.msg)
					
	select	tctax941.cvat,tctax941.layr,tctax941.seqn
	from	tctax941
| 	where	tctax941._index1 = {:tdisg831.ccty, :tdisg832.cvat}
| 	where	tctax941._index1 = {:tdisg831.ccty, :tdisg831.cvat}		|GH489CR000.o
	where	tctax941._index1 = {:tdisg831.ccty, :tdisg831.ccvt}		|GH489CR000.n
	and	tctax941.amor = tctax.amor.l.not.appl
	selectdo
		if not tcmcs.dll0036.get.indirect.tax.l(	tdisg831.ccty, 
								tctax941.cvat,
								o.indt.l) then	|* Indirect Tax Type	
			
		endif	
		on case o.indt.l
		case	tctax.indt.l.cgst:
			cgst.rate = cgst.rate + o.tax.rates(tctax941.layr,tctax941.seqn)
			cgst.amnt = cgst.amnt + line.tax.amount.array(tctax941.layr,tctax941.seqn)
| 			cgst.amnt = round(cgst.amnt, 0, 1)		
			cgst.amnt = round(cgst.amnt, 2, 1)			
			
			break
			
		case	tctax.indt.l.sgst:
		case	tctax.indt.l.utgst:
			sgst.rate = sgst.rate + o.tax.rates(tctax941.layr,tctax941.seqn)
			sgst.amnt = sgst.amnt + line.tax.amount.array(tctax941.layr,tctax941.seqn)	
			sgst.amnt = round(sgst.amnt, 2, 1)		
			
			break	
			
		case	tctax.indt.l.igst:
			igst.rate = igst.rate + o.tax.rates(tctax941.layr,tctax941.seqn)
			igst.amnt = igst.amnt + line.tax.amount.array(tctax941.layr,tctax941.seqn)
			igst.amnt = round(igst.amnt, 2, 1)		
			break	
		endcase					
	endselect
	
	tax.amnt = cgst.amnt + sgst.amnt + igst.amnt
}

function create.annexure.export.header()
{
	seq.puts("<table  colspan="&chr$(34)&"20"&chr$(34)&" align="&chr$(34)&"center"&chr$(34)&" style="&chr$(34)&"width: 1050px; height: auto; background: #fff; "&chr$(34)&">",fp)seq.puts("<tr>",fp)
        seq.puts("<tr>",fp)
        seq.puts("<td>",fp)
	seq.puts("<div class="&chr$(34)&"header_sub"&chr$(34)&" >",fp)
	
	seq.puts("<table>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<th colspan=20 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"><strong>ANNEXURE TO EXPORT INVOICE No.&nbsp;" & trim$(tdisg831.invn) &
			"&nbsp; DATED &nbsp;" & sprintf$("%D(%02d %-03H %04Y)", tdisg831.invd) & "</strong><br><br><br></th>",fp)
| 		seq.puts("<td colspan=5 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"> Page : 1",fp)
| 		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">Sr. No. </td>",fp)
		seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">Supplier </td>" ,fp)
		seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">Supplier's GSTIN </td>",fp)
		seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">Tax Invoice No. </td>",fp)
		seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">Date </td>",fp)
		seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">Vehicle No. </td>",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)
	
| 	seq.puts("</table>",fp)
| 	seq.puts("</div>",fp)
| 	seq.puts("</td>",fp)
| 	seq.puts("</tr>",fp)
| 	seq.puts("</table>",fp)
| 	
| 	seq.close(fp)
| 	ret2	=	server2client(file.name,local.file.name,1)
| 	ret2	=	app_start(local.file.name,"c:","","","")
}

function create.annexure.export.line()
{	
	if repeat.flag = 0 then
		ann.line.cal = ann.line.cal + 1
		seq.puts("<tr>",fp)
			seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">" & str$(o.srno) & "</td>", fp)
| 			seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& trim$(tccom100.nama) & "</td>",fp)	|GH524CR000.com
			seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& trim$(vender.name.cadr) & "</td>",fp)	|GH524CR000.a
			seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& trim$(gstn.b.no) & "</td>",fp)
			seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& trim$(tfacp100.isup) & "</td>",fp)
			seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& sprintf$("%D(%02d/%02m/%04Y)",tfacp100.invd) & "</td>",fp)
			seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& trim$(r.var.vhno) & "</td>",fp)
		seq.puts("</tr>",fp)
	endif
	
	if repeat.flag = 0 and not isspace(p.line) then
		seq.puts("<tr>",fp)
		seq.puts("<td colspan=2 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"></td>", fp)
		seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"></td>",fp)
		seq.puts("<td colspan=4 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"></td>",fp)
		seq.puts("<td colspan=10 class="&chr$(34)&"bl bt  br fta"&chr$(34)&">"& trim$(p.line) &"</td>",fp)
		seq.puts("</tr>",fp)
	endif
	
}

function create.annexure.footer()
{
	long	i
	i = 0
	
	for i = ann.line.cal to 500
		seq.puts("<tr>",fp)
			seq.puts("<td colspan=20 class="&chr$(34)&"bl bt br bb fta"&chr$(34)&"></td>", fp)
		seq.puts("</tr>",fp)
	endfor
		
	seq.puts("<tr>",fp)
		seq.puts("<td colspan=14 class="&chr$(34)&"bl bt  br fta"&chr$(34)&"></td>", fp)
		seq.puts("<td colspan=6 rowspan=1  valign="&chr$(34)&"top"&chr$(34)&" class="&chr$(34)&"tal fta"&chr$(34)
			&"><strong>FOR ISGEC HEAVY ENGINEERING LTD.<br><br><br><br><br>Authorised Signatory</strong>",fp)
		seq.puts("</td >",fp)
	seq.puts("</tr>",fp)

	seq.puts("</table>",fp)
	seq.puts("</div>",fp)
	seq.puts("</td>",fp)
	seq.puts("</tr>",fp)
	seq.puts("</table>",fp)
	
	seq.close(fp)
	ret2	=	server2client(file.name,local.file.name,1)
	ret2	=	app_start(local.file.name,"c:","","","")
}
